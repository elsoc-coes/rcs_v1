levels = 1:4,
labels = c("Votante\nCrónico (64.24%)", "Desafecto (8.30%)", "No-Votante\nCrónico (14.28%)", "Activado (13.17%)"))) %>%
mutate(pp_5 = factor(pp_5,
levels = 1:5,
labels = c("1 (14.27%)", "2 (11.44%)", "3 (4.73%)",
"4 (6.33%)", "5 (63.24%)")))
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
as_label(ola) %>%
prop(c02 == 1, by = c(ola, pp_3), na.rm = TRUE) %>%
filter(!is.na(pp_3)) %>%
ggplot(aes(y = prop, x = ola,
color = pp_3, group = pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3, nudge_y = .01) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = '',
subtitle = 'Casi siempre se puede confiar en las personas') +
scale_y_continuous(labels = scales::percent,
limits = c(0, .2)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
rm(list=ls())
library(knitr)
library(tidyverse)
library(sjmisc)
library(sjlabelled)
library(ggrepel)
library(ggalluvial)
library(survey)
library(elsoc)
library(lubridate)
library(viridis)
library(statar)
library(tidyverse)
options(dplyr.summarise.inform = FALSE)
load(file.path('..', 'inputs', 'ELSOC_Long_2016_2022_v1.00_R.RData'))
load(file.path('..', 'inputs', 'ELSOC_Wide_2016_2022_v1.00_R.RData'))
elsoc_long_2016_2022 <- elsoc_long.0 %>%
mutate(pleb = case_when(c55 == 4 ~ 5,
c55 == 1 ~ 1,
c55 == 2 ~ 2,
c55 == 3 ~ 3,
c55 == -999 ~ 5,
c55 == -888 ~ 5,
c55 == -777 ~ 5,
c55 == -666 ~ 5,
c56 == -999 ~ 5,
c56 == -888 ~ 5,
c56 == -777 ~ 5,
c56 == -666 ~ 5,
c56 == 2 ~ 4,
c57 == 1 ~ 1,
c57 == 2 ~ 2,
c57 == 3 ~ 3,
c57 == -999 ~ 5,
c57 == -888 ~ 5,
c57 == -777 ~ 5,
c57 == -666 ~ 5))  %>%
group_by(idencuesta) %>%
mutate(salida = ifelse(length(na.omit(pleb)) == 0, NA, max(pleb, na.rm = T))) %>%
ungroup()
elsoc_long.0 <- elsoc_long_2016_2022
elsoc_long_2016_2022 <- elsoc_long.0 %>%
mutate(pleb = case_when(c55 == 4 ~ 5,
c55 == 1 ~ 1,
c55 == 2 ~ 2,
c55 == 3 ~ 3,
c55 == -999 ~ 5,
c55 == -888 ~ 5,
c55 == -777 ~ 5,
c55 == -666 ~ 5,
c56 == -999 ~ 5,
c56 == -888 ~ 5,
c56 == -777 ~ 5,
c56 == -666 ~ 5,
c56 == 2 ~ 4,
c57 == 1 ~ 1,
c57 == 2 ~ 2,
c57 == 3 ~ 3,
c57 == -999 ~ 5,
c57 == -888 ~ 5,
c57 == -777 ~ 5,
c57 == -666 ~ 5))  %>%
group_by(idencuesta) %>%
mutate(salida = ifelse(length(na.omit(pleb)) == 0, NA, max(pleb, na.rm = T))) %>%
ungroup()
load(file.path('..', 'inputs', 'perfiles.RData'))
elsoc_long_2016_2022 <- elsoc_long_2016_2022 %>%
left_join(perfiles, by = "idencuesta")
elsoc_long_2016_2022 %>%
sjmisc::frq(pp_4)
elsoc_long_2016_2022 %>%
prop(pp_4)
elsoc_long_2016_2022 %>%
prop(pp_4)
elsoc_long_2016_2022 %>%
filter(ola == 1) %>%
prop(pp_4)
elsoc_long_2016_2022 %>%
filter(ola == 6) %>%
prop(pp_4)
elsoc_long_2016_2022 %>%
filter(ola == 6, !is.na(pp_4)) %>%
prop(pp_4)
elsoc_long_2016_2022 %>%
filter(ola == 6, !is.na(pp_3)) %>%
prop(pp_3)
rm(list=ls())
library(knitr)
library(tidyverse)
library(sjmisc)
library(sjlabelled)
library(ggrepel)
library(ggalluvial)
library(survey)
library(elsoc)
library(lubridate)
library(viridis)
library(statar)
library(tidyverse)
options(dplyr.summarise.inform = FALSE)
load(file.path('..', 'inputs', 'ELSOC_Long_2016_2022_v1.00_R.RData'))
load(file.path('..', 'inputs', 'ELSOC_Wide_2016_2022_v1.00_R.RData'))
elsoc_long.0 <- elsoc_long_2016_2022
elsoc_long_2016_2022 <- elsoc_long.0 %>%
mutate(pleb = case_when(c55 == 4 ~ 5,
c55 == 1 ~ 1,
c55 == 2 ~ 2,
c55 == 3 ~ 3,
c55 == -999 ~ 5,
c55 == -888 ~ 5,
c55 == -777 ~ 5,
c55 == -666 ~ 5,
c56 == -999 ~ 5,
c56 == -888 ~ 5,
c56 == -777 ~ 5,
c56 == -666 ~ 5,
c56 == 2 ~ 4,
c57 == 1 ~ 1,
c57 == 2 ~ 2,
c57 == 3 ~ 3,
c57 == -999 ~ 5,
c57 == -888 ~ 5,
c57 == -777 ~ 5,
c57 == -666 ~ 5))  %>%
group_by(idencuesta) %>%
mutate(salida = ifelse(length(na.omit(pleb)) == 0, NA, max(pleb, na.rm = T))) %>%
ungroup()
load(file.path('..', 'inputs', 'perfiles.RData'))
elsoc_long_2016_2022 <- elsoc_long_2016_2022 %>%
left_join(perfiles, by = "idencuesta")
mutate(pp_3 = factor(pp_3,
levels = 1:3,
labels = c("Votante Habitual (70.3%)", "No-Votante (17.3%)", "Votante Reactivo (12.3%)"))) %>%
mutate(pp_4 = factor(pp_4,
levels = 1:4,
labels = c("1 (10.90%)", "2 (8.29%)", " 3 (69.28%)", "4 (11.53%)"))) %>%
mutate(pp_5 = factor(pp_5,
levels = 1:5,
labels = c("1 (10.90%)", "2 (10.78%)", "3 (57.75%)",
"4 (5.34%)", "5 (15.24%)")))
load(file.path('..', 'inputs', 'ELSOC_Long_2016_2022_v1.00_R.RData'))
load(file.path('..', 'inputs', 'ELSOC_Wide_2016_2022_v1.00_R.RData'))
elsoc_long.0 <- elsoc_long_2016_2022
elsoc_long_2016_2022 <- elsoc_long.0 %>%
mutate(pleb = case_when(c55 == 4 ~ 5,
c55 == 1 ~ 1,
c55 == 2 ~ 2,
c55 == 3 ~ 3,
c55 == -999 ~ 5,
c55 == -888 ~ 5,
c55 == -777 ~ 5,
c55 == -666 ~ 5,
c56 == -999 ~ 5,
c56 == -888 ~ 5,
c56 == -777 ~ 5,
c56 == -666 ~ 5,
c56 == 2 ~ 4,
c57 == 1 ~ 1,
c57 == 2 ~ 2,
c57 == 3 ~ 3,
c57 == -999 ~ 5,
c57 == -888 ~ 5,
c57 == -777 ~ 5,
c57 == -666 ~ 5))  %>%
group_by(idencuesta) %>%
mutate(salida = ifelse(length(na.omit(pleb)) == 0, NA, max(pleb, na.rm = T))) %>%
ungroup()
load(file.path('..', 'inputs', 'perfiles.RData'))
elsoc_long_2016_2022 <- elsoc_long_2016_2022 %>%
left_join(perfiles, by = "idencuesta") %>%
mutate(pp_3 = factor(pp_3,
levels = 1:3,
labels = c("Votante Habitual (70.3%)", "No-Votante (17.3%)", "Votante Reactivo (12.3%)"))) %>%
mutate(pp_4 = factor(pp_4,
levels = 1:4,
labels = c("1 (10.90%)", "2 (8.29%)", " 3 (69.28%)", "4 (11.53%)"))) %>%
mutate(pp_5 = factor(pp_5,
levels = 1:5,
labels = c("1 (10.90%)", "2 (10.78%)", "3 (57.75%)",
"4 (5.34%)", "5 (15.24%)")))
elsoc_wide_2016_2022 <- elsoc_wide_2016_2022 %>%
left_join(perfiles, by = "idencuesta") %>%
mutate(pp_3 = factor(pp_3,
levels = 1:3,
labels = c("Votante Habitual (70.3%)", "No-Votante (17.3%)", "Votante Reactivo (12.3%)"))) %>%
mutate(pp_4 = factor(pp_4,
levels = 1:4,
labels = c("1 (10.90%)", "2 (8.29%)", " 3 (69.28%)", "4 (11.53%)"))) %>%
mutate(pp_5 = factor(pp_5,
levels = 1:5,
labels = c("1 (10.90%)", "2 (10.78%)", "3 (57.75%)",
"4 (5.34%)", "5 (15.24%)")))
rm(list=ls())
library(knitr)
library(tidyverse)
library(sjmisc)
library(sjlabelled)
library(ggrepel)
library(ggalluvial)
library(survey)
library(elsoc)
library(lubridate)
library(viridis)
library(statar)
library(tidyverse)
options(dplyr.summarise.inform = FALSE)
load(file.path('..', 'inputs', 'ELSOC_Long_2016_2022_v1.00_R.RData'))
load(file.path('..', 'inputs', 'ELSOC_Wide_2016_2022_v1.00_R.RData'))
elsoc_long.0 <- elsoc_long_2016_2022
elsoc_long_2016_2022 <- elsoc_long.0 %>%
mutate(pleb = case_when(c55 == 4 ~ 5,
c55 == 1 ~ 1,
c55 == 2 ~ 2,
c55 == 3 ~ 3,
c55 == -999 ~ 5,
c55 == -888 ~ 5,
c55 == -777 ~ 5,
c55 == -666 ~ 5,
c56 == -999 ~ 5,
c56 == -888 ~ 5,
c56 == -777 ~ 5,
c56 == -666 ~ 5,
c56 == 2 ~ 4,
c57 == 1 ~ 1,
c57 == 2 ~ 2,
c57 == 3 ~ 3,
c57 == -999 ~ 5,
c57 == -888 ~ 5,
c57 == -777 ~ 5,
c57 == -666 ~ 5))  %>%
group_by(idencuesta) %>%
mutate(salida = ifelse(length(na.omit(pleb)) == 0, NA, max(pleb, na.rm = T))) %>%
ungroup()
load(file.path('..', 'inputs', 'perfiles.RData'))
elsoc_long_2016_2022 <- elsoc_long_2016_2022 %>%
left_join(perfiles, by = "idencuesta") %>%
mutate(pp_3 = factor(pp_3,
levels = 1:3,
labels = c("Votante Habitual (70.3%)", "No-Votante (17.3%)", "Votante Reactivo (12.3%)"))) %>%
mutate(pp_4 = factor(pp_4,
levels = 1:4,
labels = c("1 (10.90%)", "2 (8.29%)", " 3 (69.28%)", "4 (11.53%)"))) %>%
mutate(pp_5 = factor(pp_5,
levels = 1:5,
labels = c("1 (10.90%)", "2 (10.78%)", "3 (57.75%)",
"4 (5.34%)", "5 (15.24%)")))
elsoc_wide_2016_2022 <- elsoc_wide_2016_2022 %>%
left_join(perfiles, by = "idencuesta") %>%
mutate(pp_3 = factor(pp_3,
levels = 1:3,
labels = c("Votante Habitual (70.3%)", "No-Votante (17.3%)", "Votante Reactivo (12.3%)"))) %>%
mutate(pp_4 = factor(pp_4,
levels = 1:4,
labels = c("1 (10.90%)", "2 (8.29%)", " 3 (69.28%)", "4 (11.53%)"))) %>%
mutate(pp_5 = factor(pp_5,
levels = 1:5,
labels = c("1 (10.90%)", "2 (10.78%)", "3 (57.75%)",
"4 (5.34%)", "5 (15.24%)")))
tab2 <- elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1) %>%
filter(ola == 3) %>%
filter(!is.na(c11), !is.na(pp_3)) %>%
mutate(c11 = factor(car::recode(c11, "1 = 2; 2:3 = 1"),
levels = 1:2,
labels = c('No votó', 'Votó'))) %>%
prop(c11, by = pp_3, na.rm = T) %>%
rename(Participa = c11) %>%
mutate(var = 2)
tab3 <- elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1) %>%
filter(ola == 5) %>%
filter(!is.na(c43), !is.na(pp_3)) %>%
mutate(c43 = factor(car::recode(c43, "1 = 2; 2:3 = 1"),
levels = 1:2,
labels = c('No votó', 'Votó'))) %>%
prop(c43, by = pp_3, na.rm = T) %>%
rename(Participa = c43) %>%
mutate(var = 3)
tab4 <- elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1) %>%
filter(ola == 6) %>%
filter(!is.na(c54), !is.na(pp_3)) %>%
mutate(c54 = factor(car::recode(c54, "1 = 2; 2 = 1"),
levels = 1:2,
labels = c('No votó', 'Votó'))) %>%
prop(c54, by = pp_3, na.rm = T) %>%
rename(Participa = c54) %>%
mutate(var = 4)
tab5 <- elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1) %>%
filter(ola == 6) %>%
filter(!is.na(c50), !is.na(pp_3)) %>%
mutate(c50 = factor(car::recode(c50, "1 = 2; 2 = 1"),
levels = 1:2,
labels = c('No votó', 'Votó'))) %>%
prop(c50, by = pp_3, na.rm = T) %>%
rename(Participa = c50) %>%
mutate(var = 5)
tab6 <- elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1) %>%
filter(ola == 6) %>%
filter(!is.na(c52), !is.na(pp_3)) %>%
mutate(c52 = factor(car::recode(c52, "1 = 2; 2 = 1"),
levels = 1:2,
labels = c('No votó', 'Votó'))) %>%
prop(c52, by = pp_3, na.rm = T) %>%
rename(Participa = c52) %>%
mutate(var = 6)
tab <- rbind(tab2, tab3, tab4, tab5, tab6) %>%
mutate(var = factor(var, levels = 2:6,
labels = c("Elecciones\nPresidenciales de 2017",
"Plebiscito de\nEntrada 2020",
"Convención y Municipales\nde 2021",
"Elecciones Presidenciales\nde 2021 (1° vuelta)",
"Elecciones Presidenciales\nde 2021 (2° vuelta)")))
rm(tab2, tab3, tab4, tab5, tab6)
tab %>%
ggplot(aes(x = prop, y = var, fill = Participa)) +
geom_bar(stat = 'identity', position = 'stack') +
facet_grid(~ pp_3) +
labs(y = NULL, x = NULL, title = NULL, fill = NULL) +
scale_x_continuous(labels = scales::percent) +
theme_bw() +
theme(plot.caption = element_text(hjust = 0),
axis.text.x = element_text(size = rel(.9)),
legend.position = 'top',
legend.title = element_blank()) +
scale_fill_viridis_d(begin = 0, end = .8) +
guides(fill = guide_legend(reverse = TRUE)) +
ggtitle('', subtitle = 'Tres clases latentes')
elsoc_long_2016_2022 %>%
filter(!is.na(pp_3)) %>%
filter(tipo_atricion == 1 & ola %in% c(1,3,5,6) &
!is_nsnr(c11, c43, c50, c52, c54, c56)) %>%
mutate(pp_3 = factor(pp_3,
labels = c("Votante Habitual", "No-votante", "Votante Reactivo"))) %>%
prop_list(c11 == 1, c43 == 1, c50 == 1, c52 == 1, c54 == 1, c56 == 1,
by = c(ola, pp_3), na.rm = T) %>%
mutate(ola = paste(name, ola)) %>%
mutate(ola = case_when(ola == 'c11 == 1 1' ~ 1,
ola == 'c11 == 1 3' ~ 2,
ola == 'c43 == 1 5' ~ 3,
ola == 'c54 == 1 6' ~ 4,
ola == 'c50 == 1 6' ~ 5,
ola == 'c52 == 1 6' ~ 6,
ola == 'c56 == 1 6' ~ 7)) %>%
mutate(ola = factor(ola,
levels = 1:7,
labels = c('Elecciones\nPresidenciales\nde 2013',
'Elecciones\nPresidenciales\nde 2017',
'Plebiscito de\nEntrada\n2020',
'Convención y\nMunicipales\nde 2021',
'Elecciones\nPresidenciales\nde 2021\n(1° vuelta)',
'Elecciones\nPresidenciales\nde 2021\n(2° vuelta)',
'Plebiscito\nSalida\n2022'))) %>%
ggplot(aes(y = prop, x = ola, group = pp_3, color = pp_3,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(size = 3, nudge_y = .02) +
scale_y_continuous(labels = scales::percent,
limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .8, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('', subtitle = 'Porcentaje que votó en...')
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1) %>%
filter(ola == 6) %>%
filter(!is.na(m0_sexo), !is.na(pp_3)) %>%
mutate(m0_sexo = factor(m0_sexo,
levels = 1:2,
labels = c("Hombre", "Mujer"))) %>%
mutate(pp_3 = factor(pp_3,
labels = c("Votante\nHabitual", "No-votante", "Votante\nReactivo"))) %>%
prop(m0_sexo, by = pp_3, na.rm = TRUE) %>%
ggplot(aes(x = prop, y = fct_rev(pp_3), fill = fct_rev(m0_sexo),
label = scales::percent(prop, .1))) +
geom_bar(stat = 'identity', position = 'stack') +
labs(y = NULL, x = NULL, title = NULL, fill = NULL) +
scale_x_continuous(labels = scales::percent) +
guides(fill = guide_legend(reverse = TRUE)) +
geom_text(position = position_stack(vjust = .5), size = 3,
color = rep(c('black', 'white'), 3)) +
theme_bw() +
scale_fill_viridis_d(begin = 0, end = .8, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
axis.text.x = element_text(size = rel(.9)),
legend.position = 'top',
legend.title = element_blank())
rm(list=ls())
library(knitr)
library(tidyverse)
library(sjmisc)
library(sjlabelled)
library(ggrepel)
library(ggalluvial)
library(survey)
library(elsoc)
library(lubridate)
library(viridis)
library(statar)
library(tidyverse)
options(dplyr.summarise.inform = FALSE)
load(file.path('..', 'inputs', 'ELSOC_Long_2016_2022_v1.00_R.RData'))
sjmisc::find_in_data(elsoc_long_2016_2022, 'plebiscito')
sjmisc::frq(elsoc_long_2016_2022$c56)
elsoc_long_2016_2022 %>%
filter(ola == 6) %>%
mutate(post_plebiscito = (!is.na(c56))) %>%
sjmisc::frq(post_plebiscito)
rm(list=ls())
library(knitr)
library(tidyverse)
library(sjmisc)
library(sjlabelled)
library(ggrepel)
library(ggalluvial)
library(survey)
library(elsoc)
library(lubridate)
library(viridis)
library(statar)
library(tidyverse)
options(dplyr.summarise.inform = FALSE)
load(file.path('..', 'inputs', 'ELSOC_Long_2016_2022_v1.00_R.RData'))
load(file.path('..', 'inputs', 'ELSOC_Wide_2016_2022_v1.00_R.RData'))
elsoc_long.0 <- elsoc_long_2016_2022
elsoc_long_2016_2022 <- elsoc_long.0 %>%
mutate(pleb = case_when(c55 == 4 ~ 5,
c55 == 1 ~ 1,
c55 == 2 ~ 2,
c55 == 3 ~ 3,
c55 == -999 ~ 5,
c55 == -888 ~ 5,
c55 == -777 ~ 5,
c55 == -666 ~ 5,
c56 == -999 ~ 5,
c56 == -888 ~ 5,
c56 == -777 ~ 5,
c56 == -666 ~ 5,
c56 == 2 ~ 4,
c57 == 1 ~ 1,
c57 == 2 ~ 2,
c57 == 3 ~ 3,
c57 == -999 ~ 5,
c57 == -888 ~ 5,
c57 == -777 ~ 5,
c57 == -666 ~ 5))  %>%
group_by(idencuesta) %>%
mutate(salida = ifelse(length(na.omit(pleb)) == 0, NA, max(pleb, na.rm = T))) %>%
ungroup()
load(file.path('..', 'inputs', 'perfiles.RData'))
elsoc_long_2016_2022 <- elsoc_long_2016_2022 %>%
left_join(perfiles, by = "idencuesta") %>%
mutate(pp_3 = factor(pp_3,
levels = 1:3,
labels = c("Votante Habitual (70.3%)", "No-Votante (17.3%)", "Votante Reactivo (12.3%)"))) %>%
mutate(pp_4 = factor(pp_4,
levels = 1:4,
labels = c("1 (10.90%)", "2 (8.29%)", " 3 (69.28%)", "4 (11.53%)"))) %>%
mutate(pp_5 = factor(pp_5,
levels = 1:5,
labels = c("1 (10.90%)", "2 (10.78%)", "3 (57.75%)",
"4 (5.34%)", "5 (15.24%)")))
elsoc_wide_2016_2022 <- elsoc_wide_2016_2022 %>%
left_join(perfiles, by = "idencuesta") %>%
mutate(pp_3 = factor(pp_3,
levels = 1:3,
labels = c("Votante Habitual (70.3%)", "No-Votante (17.3%)", "Votante Reactivo (12.3%)"))) %>%
mutate(pp_4 = factor(pp_4,
levels = 1:4,
labels = c("1 (10.90%)", "2 (8.29%)", " 3 (69.28%)", "4 (11.53%)"))) %>%
mutate(pp_5 = factor(pp_5,
levels = 1:5,
labels = c("1 (10.90%)", "2 (10.78%)", "3 (57.75%)",
"4 (5.34%)", "5 (15.24%)")))
sjmisc::frq(elsoc_long_2016_2022$c37_03)
elsoc::describe_elsoc('c37_03')
