xlab(label = NULL) +
scale_color_viridis_d(begin = .1, end = .66, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Conflictividad barrial alta, según ola y voto en plebiscito de salida',
subtitle = 'Porcentaje que Muchas veces o siempre presenta Molestia o incomodidad por problemas con sus vecinos')
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(tipo_atricion %in% c(1, 33),
!is_nsnr(t11_01, t11_02, t11_03, t11_04)) %>%
mutate(barrio_confli = (t11_01 + t11_02 + t11_03 + t11_04)/4,
barrio_confli_rec = factor(cut(barrio_confli, breaks = c(0, 1, 2.75, 5)),
labels = c("Nunca", "Pocas o algunas veces", "Muchas veces o siempre")),
voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros"))) %>%
sjlabelled::as_label(ola) %>%
prop(barrio_confli_rec == 'Muchas veces o siempre',
by = c(ola, voto_salida), na.rm = TRUE) %>%
filter(!is.na(voto_salida), voto_salida %in% c('Apruebo', 'Rechazo')) %>%
ggplot(aes(y = prop, x = ola, color = voto_salida, group = voto_salida,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,
limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = .1, end = .66, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Conflictividad barrial alta, según ola y voto en plebiscito de salida',
subtitle = 'Porcentaje que Muchas veces o siempre presenta Molestia o incomodidad por\nproblemas con sus vecinos')
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(tipo_atricion %in% c(1, 33), ola %in% 5 ) %>%
mutate(voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
voto_entrada = factor(case_when(c43 == 1 & c44 == 1 ~ 1,
c43 == 1 & c44 == 2 ~ 2,
c43 == 2 ~ 3,
TRUE ~ 4),
levels = 1:4,
labels = c('Apruebo', 'Rechazo', 'No votó', 'NS/NR'))) %>%
prop(voto_salida, by = voto_entrada, na.rm = TRUE) %>%
filter(!is.na(voto_entrada)) %>%
ggplot(aes(x = prop, y = fct_rev(voto_entrada), fill = fct_rev(voto_salida),
label = scales::percent(prop, accuracy = .1))) +
geom_col(position = 'stack') +
scale_x_continuous(labels = scales::percent) +
guides(fill = guide_legend(reverse = TRUE)) +
geom_text(position = position_stack(vjust = .5), size = 3,
color = rep(c('black', 'white', 'white'), 4)) +
theme_bw() +
labs(y = 'Voto en plebiscito de entrada (2021)',
x = NULL, title = NULL, fill = NULL) +
scale_fill_viridis_d(begin = 0, end = .8, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
axis.text.x = element_text(size = rel(.9)),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Voto en plebiscito de salida (2022), según voto en plebiscito de entrada (2021)')
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(!is.na(t10), tipo_atricion %in% c(1, 33), ola == 6) %>%
mutate(voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
zona = factor(case_when(region_cod %in% c(1:4, 15) ~ 'Norte',
region_cod %in% c(5:8, 16) ~ 'Centro',
region_cod %in% c(9:12, 14) ~ 'Sur',
region_cod == 13 ~ 'Metropolitana'))) %>%
prop(voto_salida, by = zona, na.rm = TRUE) %>%
ggplot(aes(y = prop, x = zona, fill = fct_rev(voto_salida),
label = scales::percent(prop, accuracy = .1))) +
geom_col(position = 'stack') +
labs(y = NULL, x = NULL, title = NULL, fill = NULL) +
scale_y_continuous(labels = scales::percent) +
guides(fill = guide_legend(reverse = TRUE)) +
geom_text(position = position_stack(vjust = .5), size = 3,
color = rep(c('black', 'white', 'white'), 4)) +
theme_bw() +
scale_fill_viridis_d(begin = 0, end = .8, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
axis.text.x = element_text(size = rel(.9)),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Voto en plebiscito de salida, según zona geográfica')
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(!is.na(t10), tipo_atricion %in% c(1, 33), ola == 6) %>%
mutate(voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
zona = factor(case_when(region_cod %in% c(1:4, 15) ~ 'Norte',
region_cod %in% c(5:8, 16) ~ 'Centro',
region_cod %in% c(9:12, 14) ~ 'Sur',
region_cod == 13 ~ 'Metropolitana'))) %>%
prop(voto_salida, by = zona, na.rm = TRUE) %>%
ggplot(aes(y = prop, x = zona, fill = fct_rev(voto_salida),
label = scales::percent(prop, accuracy = .1))) +
geom_col(position = 'stack') +
labs(y = NULL, x = NULL, title = NULL, fill = NULL) +
scale_y_continuous(labels = scales::percent) +
guides(fill = guide_legend(reverse = TRUE)) +
geom_text(position = position_stack(vjust = .5), size = 3,
color = rep(c('black', 'white', 'white'), 4)) +
theme_bw() +
scale_fill_viridis_d(begin = 0, end = .8, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
axis.text.x = element_text(size = rel(.9)),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Voto en plebiscito de salida, según zona geográfica')
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(tipo_atricion %in% c(1, 33),
!is_nsnr(t11_01, t11_02, t11_03, t11_04)) %>%
mutate(barrio_confli = (t11_01 + t11_02 + t11_03 + t11_04)/4,
barrio_confli_rec = factor(cut(barrio_confli, breaks = c(0, 1, 2.75, 5)),
labels = c("Nunca", "Pocas o algunas veces", "Muchas veces o siempre")),
voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros"))) %>%
sjlabelled::as_label(ola) %>%
prop(barrio_confli_rec == 'Muchas veces o siempre',
by = c(ola, voto_salida), na.rm = TRUE) %>%
filter(!is.na(voto_salida), voto_salida %in% c('Apruebo', 'Rechazo')) %>%
ggplot(aes(y = prop, x = ola, color = voto_salida, group = voto_salida,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,
limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = .1, end = .66, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Conflictividad barrial alta, según ola y voto en plebiscito de salida',
subtitle = 'Porcentaje que Muchas veces o siempre presenta Molestia o incomodidad por\nproblemas con sus vecinos')
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(tipo_atricion %in% c(1, 33), ola %in% 5:6,
!is_nsnr(t11_01, t11_02, t11_03, t11_04)) %>%
mutate(barrio_confli = (t11_01 + t11_02 + t11_03 + t11_04)/4,
barrio_confli_rec = factor(cut(barrio_confli, breaks = c(0, 1, 2.75, 5)),
labels = c("Nunca", "Pocas o algunas veces", "Muchas veces o siempre")),
voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
zona = factor(case_when(region_cod %in% c(1:4, 15) ~ 'Norte',
region_cod %in% c(5:8, 16) ~ 'Centro',
region_cod %in% c(9:12, 14) ~ 'Sur',
region_cod == 13 ~ 'Metropolitana'))) %>%
sjlabelled::as_label(ola) %>%
prop(barrio_confli_rec == 'Muchas veces o siempre',
by = c(ola, voto_salida), na.rm = TRUE) %>%
filter(!is.na(voto_salida), voto_salida %in% c('Apruebo', 'Rechazo')) %>%
ggplot(aes(y = prop, x = ola, color = voto_salida, group = voto_salida,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,
limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = .1, end = .66, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Conflictividad barrial alta, según ola y voto en plebiscito de salida',
subtitle = 'Porcentaje que Muchas veces o siempre presenta Molestia o incomodidad por\nproblemas con sus vecinos')
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(tipo_atricion %in% c(1, 33), ola %in% 5:6,
!is_nsnr(t11_01, t11_02, t11_03, t11_04)) %>%
mutate(barrio_confli = (t11_01 + t11_02 + t11_03 + t11_04)/4,
barrio_confli_rec = factor(cut(barrio_confli, breaks = c(0, 1, 2.75, 5)),
labels = c("Nunca", "Pocas o algunas veces", "Muchas veces o siempre")),
voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
zona = factor(case_when(region_cod %in% c(1:4, 15) ~ 'Norte',
region_cod %in% c(5:8, 16) ~ 'Centro',
region_cod %in% c(9:12, 14) ~ 'Sur',
region_cod == 13 ~ 'Metropolitana'))) %>%
sjlabelled::as_label(ola) %>%
prop(barrio_confli_rec == 'Muchas veces o siempre',
by = c(ola, voto_salida), na.rm = TRUE) %>%
filter(!is.na(voto_salida), voto_salida %in% c('Apruebo', 'Rechazo')) %>%
ggplot(aes(y = prop, x = ola, color = voto_salida, group = voto_salida,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,
limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = .1, end = .66, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Conflictividad barrial alta, según ola y voto en plebiscito de salida',
subtitle = 'Porcentaje que Muchas veces o siempre presenta Molestia o incomodidad por\nproblemas con sus vecinos')
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(tipo_atricion %in% c(1, 33),
!is_nsnr(t11_01, t11_02, t11_03, t11_04)) %>%
mutate(barrio_confli = (t11_01 + t11_02 + t11_03 + t11_04)/4,
barrio_confli_rec = factor(cut(barrio_confli, breaks = c(0, 1, 2.75, 5)),
labels = c("Nunca", "Pocas o algunas veces", "Muchas veces o siempre")),
voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
zona = factor(case_when(region_cod %in% c(1:4, 15) ~ 'Norte',
region_cod %in% c(5:8, 16) ~ 'Centro',
region_cod %in% c(9:12, 14) ~ 'Sur',
region_cod == 13 ~ 'Metropolitana'))) %>%
sjlabelled::as_label(ola) %>%
prop(barrio_confli_rec == 'Muchas veces o siempre',
by = c(ola, voto_salida), na.rm = TRUE) %>%
filter(!is.na(voto_salida), voto_salida %in% c('Apruebo', 'Rechazo')) %>%
ggplot(aes(y = prop, x = ola, color = voto_salida, group = voto_salida,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,
limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = .1, end = .66, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Conflictividad barrial alta, según ola y voto en plebiscito de salida',
subtitle = 'Porcentaje que Muchas veces o siempre presenta Molestia o incomodidad por\nproblemas con sus vecinos')
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(tipo_atricion %in% c(1, 33), ola %in% 5:6,
!is_nsnr(t11_01, t11_02, t11_03, t11_04)) %>%
mutate(barrio_confli = (t11_01 + t11_02 + t11_03 + t11_04)/4,
barrio_confli_rec = factor(cut(barrio_confli, breaks = c(0, 1, 2.75, 5)),
labels = c("Nunca", "Pocas o algunas veces", "Muchas veces o siempre")),
voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
zona = factor(case_when(region_cod %in% c(1:4, 15) ~ 'Norte',
region_cod %in% c(5:8, 16) ~ 'Centro',
region_cod %in% c(9:12, 14) ~ 'Sur',
region_cod == 13 ~ 'Metropolitana'))) %>%
sjlabelled::as_label(ola) %>%
prop(barrio_confli_rec == 'Muchas veces o siempre',
by = c(ola, voto_salida, zona), na.rm = TRUE) %>%
filter(!is.na(voto_salida), voto_salida %in% c('Apruebo', 'Rechazo'))
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(tipo_atricion %in% c(1, 33), ola %in% 5:6,
!is_nsnr(t11_01, t11_02, t11_03, t11_04)) %>%
mutate(barrio_confli = (t11_01 + t11_02 + t11_03 + t11_04)/4,
barrio_confli_rec = factor(cut(barrio_confli, breaks = c(0, 1, 2.75, 5)),
labels = c("Nunca", "Pocas o algunas veces", "Muchas veces o siempre")),
voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
zona = factor(case_when(region_cod %in% c(1:4, 15) ~ 'Norte',
region_cod %in% c(5:8, 16) ~ 'Centro',
region_cod %in% c(9:12, 14) ~ 'Sur',
region_cod == 13 ~ 'Metropolitana'))) %>%
sjlabelled::as_label(ola) %>%
prop(barrio_confli_rec == 'Muchas veces o siempre',
by = c(ola, voto_salida, zona), na.rm = TRUE) %>%
filter(!is.na(voto_salida), voto_salida %in% c('Apruebo', 'Rechazo')) %>%
ggplot(aes(y = prop, x = ola, fill = voto_salida,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
facet_wrap(~zona) +
geom_col(position = 'dodge2') +
geom_text(position = position_dodge(.9),
vjust = -.5, size = 3) +
scale_y_continuous(labels = scales::percent,
limits = c(0, 1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .66, direction = 1, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Conflictividad barrial alta, según ola, zona y voto en plebiscito de salida',
subtitle = 'Porcentaje que Muchas veces o siempre presenta Molestia o incomodidad por\nproblemas con sus vecinos')
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(tipo_atricion %in% c(1, 33), ola %in% 5:6,
!is_nsnr(t11_01, t11_02, t11_03, t11_04)) %>%
mutate(barrio_confli = (t11_01 + t11_02 + t11_03 + t11_04)/4,
barrio_confli_rec = factor(cut(barrio_confli, breaks = c(0, 1, 2.75, 5)),
labels = c("Nunca", "Pocas o algunas veces", "Muchas veces o siempre")),
voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
zona = factor(case_when(region_cod %in% c(1:4, 15) ~ 'Norte',
region_cod %in% c(5:8, 16) ~ 'Centro',
region_cod %in% c(9:12, 14) ~ 'Sur',
region_cod == 13 ~ 'Metropolitana'))) %>%
sjlabelled::as_label(ola) %>%
prop(barrio_confli_rec == 'Muchas veces o siempre',
by = c(ola, voto_salida, zona), na.rm = TRUE) %>%
filter(!is.na(voto_salida), voto_salida %in% c('Apruebo', 'Rechazo')) %>%
ggplot(aes(y = prop, x = ola, fill = voto_salida,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
facet_wrap(~zona) +
geom_col(position = 'dodge2') +
geom_text(position = position_dodge(.9),
vjust = -.5, size = 3) +
scale_y_continuous(labels = scales::percent,
limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .66, direction = 1, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Conflictividad barrial alta, según ola, zona y voto en plebiscito de salida',
subtitle = 'Porcentaje que Muchas veces o siempre presenta Molestia o incomodidad por\nproblemas con sus vecinos')
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(tipo_atricion %in% c(1, 33), ola %in% 6,
!is_nsnr(t11_01, t11_02, t11_03, t11_04)) %>%
mutate(barrio_confli = (t11_01 + t11_02 + t11_03 + t11_04)/4,
barrio_confli_rec = factor(cut(barrio_confli, breaks = c(0, 1, 2.75, 5)),
labels = c("Nunca", "Pocas o algunas veces", "Muchas veces o siempre")),
voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
zona = factor(case_when(region_cod %in% c(1:4, 15) ~ 'Norte',
region_cod %in% c(5:8, 16) ~ 'Centro',
region_cod %in% c(9:12, 14) ~ 'Sur',
region_cod == 13 ~ 'Metropolitana'))) %>%
prop(barrio_confli_rec == 'Muchas veces o siempre',
by = c(voto_salida, zona), na.rm = TRUE) %>%
filter(!is.na(voto_salida), voto_salida %in% c('Apruebo', 'Rechazo')) %>%
ggplot(aes(y = prop, x = zona, fill = voto_salida,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_col(position = 'dodge2') +
geom_text(position = position_dodge(.9),
vjust = -.5, size = 3) +
scale_y_continuous(labels = scales::percent,
limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .66, direction = 1, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Conflictividad barrial alta, según ola, zona y voto en plebiscito de salida',
subtitle = 'Porcentaje que Muchas veces o siempre presenta Molestia o incomodidad por\nproblemas con sus vecinos')
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(tipo_atricion %in% c(1, 33), ola %in% 6,
!is_nsnr(t11_01, t11_02, t11_03, t11_04)) %>%
mutate(barrio_confli = (t11_01 + t11_02 + t11_03 + t11_04)/4,
barrio_confli_rec = factor(cut(barrio_confli, breaks = c(0, 1, 2.75, 5)),
labels = c("Nunca", "Pocas o algunas veces", "Muchas veces o siempre")),
voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
zona = factor(case_when(region_cod %in% c(1:4, 15) ~ 'Norte',
region_cod %in% c(5:8, 16) ~ 'Centro',
region_cod %in% c(9:12, 14) ~ 'Sur',
region_cod == 13 ~ 'Metropolitana'))) %>%
prop(barrio_confli_rec == 'Muchas veces o siempre',
by = c(voto_salida, zona), na.rm = TRUE) %>%
filter(!is.na(voto_salida), voto_salida %in% c('Apruebo', 'Rechazo')) %>%
ggplot(aes(y = prop, x = zona, fill = voto_salida,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_col(position = 'dodge2') +
geom_text(position = position_dodge(.9),
vjust = -.5, size = 3) +
scale_y_continuous(labels = scales::percent,
limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .66, direction = 1, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Conflictividad barrial alta (2022), según zona y voto en plebiscito de salida',
subtitle = 'Porcentaje que Muchas veces o siempre presenta Molestia o incomodidad por\nproblemas con sus vecinos')
elsoc_long_2016_2022 %>%
filter(tipo_atricion %in% c(1, 33) & !is_nsnr(t11_01, t11_02, t11_03, t11_04)) %>%
mutate(barrio_confli = (t11_01 + t11_02 + t11_03 + t11_04)/4,
barrio_confli_rec = factor(cut(barrio_confli, breaks = c(0, 1, 2.75, 5)),
labels = c("Nunca", "Pocas o algunas veces", "Muchas veces o siempre"))) %>%
sjlabelled::as_label(ola) %>%
prop(x = barrio_confli_rec, by = ola, na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, fill = fct_rev(barrio_confli_rec),
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_col(position = 'Stack') +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .85) +
ggtitle(label = 'Conflictos barriales, según ola',
subtitle = 'Porcentaje que presenta Molestia o incomodidad por problemas con sus vecinos') +
guides(fill = guide_legend(reverse = TRUE)) +
geom_text(position = position_stack(vjust = .5),
size = 3,
color = rep(c('black', 'white', 'white'), 6)) +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(tipo_atricion %in% c(1, 33), ola %in% 6,
!is_nsnr(t11_01, t11_02, t11_03, t11_04)) %>%
mutate(barrio_confli = (t11_01 + t11_02 + t11_03 + t11_04)/4,
barrio_confli_rec = factor(cut(barrio_confli, breaks = c(0, 1, 2.75, 5)),
labels = c("Nunca", "Pocas o algunas veces", "Muchas veces o siempre")),
voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
zona = factor(case_when(region_cod %in% c(1:4, 15) ~ 'Norte',
region_cod %in% c(5:8, 16) ~ 'Centro',
region_cod %in% c(9:12, 14) ~ 'Sur',
region_cod == 13 ~ 'Metropolitana'))) %>%
prop(barrio_confli_rec == 'Muchas veces o siempre',
by = c(voto_salida, zona), na.rm = TRUE) %>%
filter(!is.na(voto_salida), voto_salida %in% c('Apruebo', 'Rechazo')) %>%
ggplot(aes(y = prop, x = zona, fill = voto_salida,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_col(position = 'dodge2') +
geom_text(position = position_dodge(.9),
vjust = -.5, size = 3) +
scale_y_continuous(labels = scales::percent,
limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .66, direction = 1, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Conflictividad barrial alta (2022), según zona y voto en plebiscito de salida',
subtitle = 'Porcentaje que Muchas veces o siempre presenta Molestia o incomodidad por\nproblemas con sus vecinos')
elsoc_long_2016_2022 %>%
left_join(voto_salida, by = 'idencuesta') %>%
filter(tipo_atricion %in% c(1, 33),
!is_nsnr(t11_01, t11_02, t11_03, t11_04)) %>%
mutate(barrio_confli = (t11_01 + t11_02 + t11_03 + t11_04)/4,
barrio_confli_rec = factor(cut(barrio_confli, breaks = c(0, 1, 2.75, 5)),
labels = c("Nunca", "Pocas o algunas veces", "Muchas veces o siempre")),
voto_salida = factor(car::recode(voto_salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros"))) %>%
sjlabelled::as_label(ola) %>%
prop(barrio_confli_rec == 'Muchas veces o siempre',
by = c(ola, voto_salida), na.rm = TRUE) %>%
filter(!is.na(voto_salida), voto_salida %in% c('Apruebo', 'Rechazo')) %>%
ggplot(aes(y = prop, x = ola, color = voto_salida, group = voto_salida,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,
limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = .1, end = .66, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Conflictividad barrial alta, según ola y voto en plebiscito de salida',
subtitle = 'Porcentaje que Muchas veces o siempre presenta Molestia o incomodidad por\nproblemas con sus vecinos')
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
sjlabelled::as_label(ola) %>%
filter(!is.na(t10), tipo_atricion %in% c(1, 33)) %>%
prop(t10 %in% 1:2, by = c(ola, pp_4), na.rm = TRUE)  %>%
filter(!is.na(pp_4)) %>%
ggplot(aes(y = prop, x = ola, color = pp_4, group = pp_4,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent, limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = .1, end = .9, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Percepción de inseguridad barrial, según perfiles de participación electoral',
subtitle = 'Porcentaje que se siente Inseguro o Muy Inseguro en su barrio')
