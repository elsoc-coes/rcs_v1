ggtitle('',
subtitle = 'Bastante o muy sobrecargado por deudas')
)
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
sjlabelled::as_label(ola) %>%
prop_list(m43 %in% 4:5, by = c(ola, pp_3), na.rm = TRUE) %>%
drop_na() %>%
ggplot(aes(x = ola, y = prop, color = pp_3,group=pp_3,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .8, option = 'viridis')+
scale_y_continuous(labels = scales::percent, limits = c(.25, 1))+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle(label = '',
subtitle = "Bastante o muy sobrecargado por deudas")
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
sjlabelled::as_label(ola) %>%
prop_list(s01 %in% 4:5, by = c(ola, pp_3), na.rm = TRUE) %>%
drop_na() %>%
ggplot(aes(x = ola, y = prop, color = pp_3,group=pp_3,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .8, option = 'viridis')+
scale_y_continuous(labels = scales::percent, limits = c(0, 1))+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle(label = '',
subtitle = "Se siente satisfecho o totalmente satisfecho con su vida")
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
sjlabelled::as_label(ola) %>%
prop_list(m43 %in% 4:5, by = c(ola, pp_3), na.rm = TRUE) %>%
drop_na() %>%
ggplot(aes(x = ola, y = prop, color = pp_3,group=pp_3,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .8, option = 'viridis')+
scale_y_continuous(labels = scales::percent, limits = c(0, 1))+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle(label = '',
subtitle = "Bastante o muy sobrecargado por deudas")
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, ola %in% c(1, 3, 5)) %>%
sjlabelled::as_label(ola) %>%
prop_list(m43 %in% 4:5, by = c(ola, pp_3), na.rm = TRUE) %>%
drop_na() %>%
ggplot(aes(x = ola, y = prop, color = pp_3,group=pp_3,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .8, option = 'viridis')+
scale_y_continuous(labels = scales::percent, limits = c(0, 1))+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle(label = '',
subtitle = "Bastante o muy sobrecargado por deudas")
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, ola %in% c(1, 3, 5)) %>%
sjlabelled::as_label(ola) %>%
prop_list(m43 %in% 4:5, by = c(ola, pp_3), na.rm = TRUE) %>%
drop_na() %>%
ggplot(aes(x = ola, y = prop, color = pp_3,group=pp_3,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .8, option = 'viridis')+
scale_y_continuous(labels = scales::percent, limits = c(0, .5))+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle(label = '',
subtitle = "Bastante o muy sobrecargado por deudas")
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, ola %in% c(1, 3, 5)) %>%
sjlabelled::as_label(ola) %>%
prop_list(m43 %in% 4:5, by = c(ola, pp_3), na.rm = TRUE) %>%
drop_na() %>%
ggplot(aes(x = ola, y = prop, color = pp_3,group=pp_3,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .8, option = 'viridis')+
scale_y_continuous(labels = scales::percent, limits = c(0, .5))+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle(label = '',
subtitle = "Bastante o muy sobrecargado por deudas")
elsoc_cohesion %>%
filter(tipo_atricion == 1) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg_rec, by = ola, na.rm = T) %>%
ggplot(aes(y = prop, x = ola, fill = fct_rev(mov_interg_rec),
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_col(position = 'Stack') +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .8, direction = -1) +
scale_y_continuous(labels = scales::percent) +
guides(fill = guide_legend(reverse = TRUE)) +
geom_text(position = position_stack(vjust = .5),
size = 3,
color = rep(c('white', 'white', 'black'), 6)) +
theme(legend.position = 'top',
legend.title = element_blank(),
plot.caption = element_text(hjust = 0)) +
ggtitle('', subtitle = 'Presenta perspetiva de movilidad ascendente') +
labs(caption = 'Nota: La perspectiva de movilidad social ascendente corresponde a la diferencia entre el estatus social esperado del hijo\ny el estatus social subjetivo del encuestado')
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg_rec, by = ola, na.rm = T) %>%
ggplot(aes(y = prop, x = ola, fill = fct_rev(mov_interg_rec),
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_col(position = 'Stack') +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .8, direction = -1) +
scale_y_continuous(labels = scales::percent) +
guides(fill = guide_legend(reverse = TRUE)) +
geom_text(position = position_stack(vjust = .5),
size = 3,
color = rep(c('white', 'white', 'black'), 6)) +
theme(legend.position = 'top',
legend.title = element_blank(),
plot.caption = element_text(hjust = 0)) +
ggtitle('', subtitle = 'Presenta perspetiva de movilidad ascendente') +
labs(caption = 'Nota: La perspectiva de movilidad social ascendente corresponde a la diferencia entre el estatus social esperado del hijo\ny el estatus social subjetivo del encuestado')
gf_cs_bienestar_movilidad_evolucion <- elsoc_cohesion %>%
filter(tipo_atricion == 1) %>%
mutate(mov_interg = d01_03 - d01_01,
mov_interg_rec = factor(car::recode(mov_interg, "-8:-1 = 1; 0 = 2; 1:10 = 3; else = NA"),
levels = c(1,2,3),
labels = c("Perpectiva de\nmovilidad descendente", "Perspectiva de\ninmovilidad social",
"Perspectiva de\nmovilidad ascendente"))) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg_rec, by = ola, na.rm = T) %>%
ggplot(aes(y = prop, x = ola, fill = fct_rev(mov_interg_rec),
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_col(position = 'Stack') +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .8, direction = -1) +
scale_y_continuous(labels = scales::percent) +
guides(fill = guide_legend(reverse = TRUE)) +
geom_text(position = position_stack(vjust = .5),
size = 3,
color = rep(c('white', 'white', 'black'), 6)) +
theme(legend.position = 'top',
legend.title = element_blank(),
plot.caption = element_text(hjust = 0)) +
labs(caption = 'Nota: La perspectiva de movilidad social corresponde a la diferencia entre el estatus social esperado del hijo\ny el estatus social subjetivo del encuestado')
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1) %>%
mutate(mov_interg = d01_03 - d01_01,
mov_interg_rec = factor(car::recode(mov_interg, "-8:-1 = 1; 0 = 2; 1:10 = 3; else = NA"),
levels = c(1,2,3),
labels = c("Perpectiva de\nmovilidad descendente", "Perspectiva de\ninmovilidad social",
"Perspectiva de\nmovilidad ascendente"))) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg_rec, by = ola, na.rm = T) %>%
ggplot(aes(y = prop, x = ola, fill = fct_rev(mov_interg_rec),
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_col(position = 'Stack') +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .8, direction = -1) +
scale_y_continuous(labels = scales::percent) +
guides(fill = guide_legend(reverse = TRUE)) +
geom_text(position = position_stack(vjust = .5),
size = 3,
color = rep(c('white', 'white', 'black'), 6)) +
theme(legend.position = 'top',
legend.title = element_blank(),
plot.caption = element_text(hjust = 0)) +
ggtitle('', subtitle = 'Presenta perspetiva de movilidad ascendente') +
labs(caption = 'Nota: La perspectiva de movilidad social ascendente corresponde a la diferencia entre el estatus social esperado del hijo\ny el estatus social subjetivo del encuestado')
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1) %>%
mutate(mov_interg = d01_03 - d01_01,
mov_interg_rec = factor(car::recode(mov_interg, "-8:-1 = 1; 0 = 2; 1:10 = 3; else = NA"),
levels = c(1,2,3),
labels = c("Perpectiva de\nmovilidad descendente", "Perspectiva de\ninmovilidad social",
"Perspectiva de\nmovilidad ascendente"))) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg_rec, by = ola, na.rm = T) %>%
ggplot(aes(y = prop, x = ola, color = pp_3, group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1))))+
theme_bw() +
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,limits = c(.3,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
labs(caption = 'Nota: La perspectiva de movilidad social ascendente corresponde a la diferencia entre el estatus social esperado del hijo\ny el estatus social subjetivo del encuestado')
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
mutate(mov_interg = d01_03 - d01_01,
mov_interg_rec = factor(car::recode(mov_interg, "-8:-1 = 1; 0 = 2; 1:10 = 3; else = NA"),
levels = c(1,2,3),
labels = c("Perpectiva de\nmovilidad descendente", "Perspectiva de\ninmovilidad social",
"Perspectiva de\nmovilidad ascendente"))) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg_rec, by = ola, na.rm = T) %>%
ggplot(aes(y = prop, x = ola, color = pp_3, group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1))))+
theme_bw() +
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,limits = c(.3,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
labs(caption = 'Nota: La perspectiva de movilidad social ascendente corresponde a la diferencia entre el estatus social esperado del hijo\ny el estatus social subjetivo del encuestado')
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
mutate(mov_interg = d01_03 - d01_01,
mov_interg_rec = factor(car::recode(mov_interg, "-8:-1 = 1; 0 = 2; 1:10 = 3; else = NA"),
levels = c(1,2,3),
labels = c("Perpectiva de\nmovilidad descendente", "Perspectiva de\ninmovilidad social",
"Perspectiva de\nmovilidad ascendente"))) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg_rec, by = ola, na.rm = T) %>%
ggplot(aes(y = prop, x = ola, color = pp_3, group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1))))+
theme_bw() +
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,limits = c(.3,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
labs(caption = 'Nota: La perspectiva de movilidad social ascendente corresponde a la diferencia entre el estatus social esperado del hijo\ny el estatus social subjetivo del encuestado')
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
mutate(mov_interg = d01_03 - d01_01) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg %in% 1:30, by = c(ola, pp_3), na.rm = T) %>%
ggplot(aes(y = prop, x = ola, color = pp_3, group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1))))+
theme_bw() +
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,limits = c(.3,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
labs(caption = 'Nota: La perspectiva de movilidad social ascendente corresponde a la diferencia entre el estatus social esperado del hijo\ny el estatus social subjetivo del encuestado')
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
mutate(mov_interg = d01_03 - d01_01) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg %in% 1:30, by = c(ola, pp_3), na.rm = T) %>%
ggplot(aes(y = prop, x = ola, color = pp_3, group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1))))+
theme_bw() +
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
labs(caption = 'Nota: La perspectiva de movilidad social ascendente corresponde a la diferencia entre el estatus social esperado del hijo\ny el estatus social subjetivo del encuestado')
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
mutate(mov_interg = d01_03 - d01_01) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg %in% 1:30, by = c(ola, pp_3), na.rm = T) %>%
filter(!is.na(pp_3)) %>%
ggplot(aes(y = prop, x = ola, color = pp_3, group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1))))+
theme_bw() +
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
labs(caption = 'Nota: La perspectiva de movilidad social ascendente corresponde a la diferencia entre el estatus social esperado del hijo\ny el estatus social subjetivo del encuestado')
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
mutate(mov_interg = d01_03 - d01_01) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg %in% 1:10, by = c(ola, pp_3), na.rm = T) %>%
filter(!is.na(pp_3)) %>%
ggplot(aes(y = prop, x = ola, color = pp_3, group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1))))+
theme_bw() +
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
labs(caption = 'Nota: La perspectiva de movilidad social ascendente corresponde a la diferencia entre el estatus social esperado del hijo\ny el estatus social subjetivo del encuestado')
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
mutate(mov_interg = d01_03 - d01_01) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg , by = c(ola, pp_3), na.rm = T) %>%
filter(!is.na(pp_3))
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
mutate(mov_interg = d01_03 - d01_01) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg %in% 1:10, by = c(ola, pp_3), na.rm = T) %>%
filter(!is.na(pp_3)) %>%
ggplot(aes(y = prop, x = ola, color = pp_3, group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1))))+
theme_bw() +
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
labs(caption = 'Nota: La perspectiva de movilidad social ascendente corresponde a la diferencia entre el estatus social esperado del hijo\ny el estatus social subjetivo del encuestado')
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
mutate(mov_interg = d01_03 - d01_01) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg %in% 1:10, by = c(ola, pp_3), na.rm = T) %>%
filter(!is.na(pp_3)) %>%
ggplot(aes(y = prop, x = ola, color = pp_3, group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1))))+
theme_bw() +
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('Presenta perspectiva de movilidad ascendente') +
labs(caption = 'Nota: La perspectiva de movilidad social ascendente corresponde a la diferencia entre el estatus social esperado del hijo\ny el estatus social subjetivo del encuestado')
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
mutate(mov_interg = d01_03 - d01_01) %>%
sjlabelled::as_label(ola) %>%
prop(x = mov_interg %in% 1:10, by = c(ola, pp_3), na.rm = T) %>%
filter(!is.na(pp_3)) %>%
ggplot(aes(y = prop, x = ola, color = pp_3, group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1))))+
theme_bw() +
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
geom_point(size = 1.75) +
geom_line() +
scale_y_continuous(labels = scales::percent,limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle('', subtitle = 'Presenta perspectiva de movilidad ascendente') +
labs(caption = 'Nota: La perspectiva de movilidad social ascendente corresponde a la diferencia entre el estatus social esperado del hijo\ny el estatus social subjetivo del encuestado')
rm(list=ls())
library(knitr)
library(tidyverse)
library(sjmisc)
library(sjlabelled)
library(ggrepel)
library(ggalluvial)
library(survey)
library(elsoc)
library(lubridate)
library(viridis)
library(statar)
library(tidyverse)
options(dplyr.summarise.inform = FALSE)
load(file.path('..', 'inputs', 'ELSOC_Long_2016_2022_v1.00_R.RData'))
load(file.path('..', 'inputs', 'ELSOC_Wide_2016_2022_v1.00_R.RData'))
# Voto en plebiscito de salida para agregar a toda la muestra:
voto_salida <- elsoc_long_2016_2022 %>%
filter(ola == 6) %>%
mutate(voto_salida = case_when(c55 == 4 ~ 5,
c55 %in% 1:3 ~ c55,
c55 %in% -666:-999 ~ 5,
c56 %in% -666:-999 ~ 5,
c56 == 2 ~ 4,
c57 %in% 1:3 ~ c57,
c57 %in% -666:-999 ~ 5
))  %>%
select(idencuesta, voto_salida)
# Cargar datos de perfiles:
load(file.path('..', 'inputs', 'perfiles.RData'))
View(perfiles)
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
as_label(ola) %>%
prop(c02 == 1, by = c(ola, pp_3), na.rm = TRUE) %>%
filter(!is.na(pp_3)) %>%
ggplot(aes(y = prop, x = ola,
color = pp_3, group = pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3, nudge_y = .01) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = '',
subtitle = 'Casi siempre se puede confiar en las personas') +
scale_y_continuous(labels = scales::percent,
limits = c(0, .2)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
as_label(ola) %>%
prop(c02 == 1, by = c(ola, pp_3), na.rm = TRUE)
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1) %>%
as_label(ola) %>%
prop(c02 == 1, by = c(ola, pp_3), na.rm = TRUE) %>%
filter(!is.na(pp_3))
