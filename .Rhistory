ylab(NULL) +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
theme(legend.position = 'none')
bind_rows(
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = ifelse(muestra==1,"Original","Refresco"),
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")"))),
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = "Total",
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")")))
) %>%
ggplot(aes(y = pct, x = fct_rev(educ), fill = educ,
label = prop)) +
facet_grid(.~muestra, scales = 'free_y') +
theme_bw() +
geom_col(position = 'dodge2',
fill = c(viridis(4, begin = .11, end = .85, direction = -1),
viridis(4, begin = .11, end = .85, direction = -1),
viridis(4, begin = .11, end = .85, direction = -1))) +
geom_text(position = position_dodge(.9), hjust = -0.1, size = 3) +
coord_flip() +
xlab(NULL) +
ylab(NULL) +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
theme(legend.position = 'none')
bind_rows(
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = ifelse(muestra==1,"Original","Refresco"),
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")"))),
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = "Total",
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")")))
) %>%
ggplot(aes(y = pct, x = fct_rev(educ), fill = educ,
label = prop)) #+
bind_rows(
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = ifelse(muestra==1,"Original","Refresco"),
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
drop_na(educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")"))),
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = "Total",
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
drop_na(educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")")))
) %>%
ggplot(aes(y = pct, x = fct_rev(educ), fill = educ,
label = prop)) #+
bind_rows(
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = ifelse(muestra==1,"Original","Refresco"),
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")"))),
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = "Total",
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")")))
) %>%
ggplot(aes(y = pct, x = fct_rev(educ), fill = educ,
label = prop)) #+
bind_rows(
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = ifelse(muestra==1,"Original","Refresco"),
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")"))),
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = "Total",
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")")))
) #%>%
m = bind_rows(
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = ifelse(muestra==1,"Original","Refresco"),
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")"))),
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = "Total",
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")")))
) #%>%
m = bind_rows(
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6 & !is.na(m01)) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = ifelse(muestra==1,"Original","Refresco"),
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")"))),
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = "Total",
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")")))
) #%>%
m = bind_rows(
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6 & !is.na(m01) & !is_nsnr(m01)) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = ifelse(muestra==1,"Original","Refresco"),
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")"))),
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = "Total",
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")")))
) #%>%
m = bind_rows(
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6 & !is.na(m01) & !is_nsnr(m01)) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = ifelse(muestra==1,"Original","Refresco"),
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")"))),
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6 & !is.na(m01) & !is_nsnr(m01)) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = "Total",
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")")))
) #%>%
ggplot(aes(y = pct, x = fct_rev(educ), fill = educ,
label = prop)) +
facet_grid(.~muestra, scales = 'free_y') +
theme_bw() +
geom_col(position = 'dodge2',
fill = c(viridis(4, begin = .11, end = .85, direction = -1),
viridis(4, begin = .11, end = .85, direction = -1),
viridis(4, begin = .11, end = .85, direction = -1))) +
geom_text(position = position_dodge(.9), hjust = -0.1, size = 3) +
coord_flip() +
xlab(NULL) +
ylab(NULL) +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
theme(legend.position = 'none')
bind_rows(
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6 & !is.na(m01) & !is_nsnr(m01)) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = ifelse(muestra==1,"Original","Refresco"),
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")"))),
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6 & !is.na(m01) & !is_nsnr(m01)) %>%
as_label(m0_sexo) %>%
mutate(educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
muestra = "Total",
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,educ) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")")))
) %>%
ggplot(aes(y = pct, x = fct_rev(educ), fill = educ,
label = prop)) +
facet_grid(.~muestra, scales = 'free_y') +
theme_bw() +
geom_col(position = 'dodge2',
fill = c(viridis(4, begin = .11, end = .85, direction = -1),
viridis(4, begin = .11, end = .85, direction = -1),
viridis(4, begin = .11, end = .85, direction = -1))) +
geom_text(position = position_dodge(.9), hjust = -0.1, size = 3) +
coord_flip() +
xlab(NULL) +
ylab(NULL) +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
theme(legend.position = 'none')
bind_rows(
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(muestra = ifelse(muestra==1,"Original","Refresco"),
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,m0_sexo) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")"))),
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(muestra = "Total",
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,m0_sexo) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")")))
) %>%
ggplot(aes(y = pct, x = fct_rev(m0_sexo), fill = m0_sexo,
label = prop)) +
facet_grid(.~muestra, scales = 'free_y') +
theme_bw() +
geom_col(position = 'dodge2',
fill = c(viridis(2, begin = .11, end = .85, direction = -1),
viridis(2, begin = .11, end = .85, direction = -1),
viridis(2, begin = .11, end = .85, direction = -1))) +
geom_text(position = position_dodge(.9), hjust = -0.1, size = 3) +
coord_flip() +
xlab(NULL) +
ylab(NULL) +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
theme(legend.position = 'none')
bind_rows(
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(edadt = factor(car::recode(m0_edad, "18:29 = 1; 30:49 = 2; 50:64 = 3; 65:150 = 4"),
levels = 1:4,
labels = c('18-29', '30-49', '50-64', '65 o más')),
muestra = ifelse(muestra==1,"Original","Refresco"),
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,edadt) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")"))),
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(edadt = factor(car::recode(m0_edad, "18:29 = 1; 30:49 = 2; 50:64 = 3; 65:150 = 4"),
levels = 1:4,
labels = c('18-29', '30-49', '50-64', '65 o más')),
muestra = "Total",
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,edadt) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")")))
) %>%
ggplot(aes(y = pct, x = fct_rev(edadt), fill = edadt,
label = prop)) +
facet_grid(.~muestra, scales = 'free_y') +
theme_bw() +
geom_col(position = 'dodge2',
fill = c(viridis(4, begin = .11, end = .85, direction = -1),
viridis(4, begin= .11, end = .85, direction = -1),
viridis(4, begin = .11, end = .85, direction = -1))) +
geom_text(position = position_dodge(.9), hjust = -0.1, size = 3) +
coord_flip() +
xlab(NULL) +
ylab(NULL) +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
theme(legend.position = 'none')
bind_rows(
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(edadt = factor(car::recode(m0_edad, "18:29 = 1; 30:49 = 2; 50:64 = 3; 65:150 = 4"),
levels = 1:4,
labels = c('18-29', '30-49', '50-64', '65 o más')),
muestra = ifelse(muestra==1,"Original","Refresco"),
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,edadt) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")"))),
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(edadt = factor(car::recode(m0_edad, "18:29 = 1; 30:49 = 2; 50:64 = 3; 65:150 = 4"),
levels = 1:4,
labels = c('18-29', '30-49', '50-64', '65 o más')),
muestra = "Total",
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
group_by(muestra,edadt) %>%
summarise(N = n(),
pct = srvyr::survey_mean(proportion = TRUE),
prop = paste0(N," (",
paste0(round(pct[,1]*100,2),"%"),")")))
) %>%
ggplot(aes(y = pct, x = fct_rev(edadt), fill = edadt,
label = prop)) +
facet_grid(.~muestra, scales = 'free_y') +
theme_bw() +
geom_col(position = 'dodge2',
fill = c(viridis(4, begin = .11, end = .85, direction = -1),
viridis(4, begin= .11, end = .85, direction = -1),
viridis(4, begin = .11, end = .85, direction = -1))) +
geom_text(position = position_dodge(.9), hjust = -0.1, size = 3) +
coord_flip() +
xlab(NULL) +
ylab(NULL) +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
theme(legend.position = 'none')
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & ola == 6) %>%
as_label(m0_sexo) %>%
mutate(edadt = factor(car::recode(m0_edad, "18:29 = 1; 30:49 = 2; 50:64 = 3; 65:150 = 4"),
levels = 1:4,
labels = c('18-29', '30-49', '50-64', '65 o más')),
educ = factor(car::recode(m01, recodes = "1:3 = 1; 4:5 = 2; 6:7 = 3; 8:10 = 4"),
levels = 1:4,
labels = c("Basica", "Media", "Tecnica", "Universitaria")),
estrato = factor(car::recode(estrato, recodes = "5:6=5"),
levels = 1:5,
labels = c("Santiago", "Valparaíso", "Concepción",
"Ciudades\ngrandes", "Medianas o\npequeñas")),
ponderador0 = 1) %>%
survey_design_elsoc(weights = ponderador0) %>%
prop_list(m0_sexo, edadt, educ, estrato, na.rm = TRUE) %>%
mutate(name = factor(name, levels = c('m0_sexo', 'edadt', 'educ', 'estrato'),
labels = c('Sexo', 'Tramo de edad', 'Nivel educacional', 'Estrato'))) %>%
ggplot(aes(y = prop, x = fct_rev(value), fill = value,
label = scales::percent(prop, .1))) +
facet_wrap(.~name, scales = 'free_y') +
theme_bw() +
geom_col(position = 'dodge2',
fill = c(viridis(2, begin = .33, end = .66, direction = -1),
viridis(4, end = .85, direction = -1),
viridis(4, end = .85, direction = -1),
viridis(5, end = .85, direction = -1))) +
geom_text(position = position_dodge(.9), hjust = -0.1, size = 3) +
coord_flip() +
xlab(NULL) +
ylab(NULL) +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
theme(legend.position = 'none')
