atricion=c(1,33),
guardar = TRUE,
guardar_como = "gf_sobrecarga_deuda_salida",
imprimir = FALSE)
# PERCEPCION SALARIOS -----------------------------------------------------
salario_percibido <- c("d03_01","d03_02")
names(salario_percibido)<- c("Empresario","Obrero")
gf_salario_percibido_perfiles <- lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_percibido[i]))})%>%
bind_rows()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según tipo de votante")
saveRDS(gf_salario_percibido_perfiles,
file="inputs/Bienestar/graficos/gf_salario_percibido_perfiles.RDS")
gf_salario_percibido_salida <-  lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,salida),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_percibido[i]))})%>%
bind_rows()%>%
filter(salida %in% c("Apruebo","Rechazo"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~salida)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según voto en Plebiscito")
saveRDS(gf_salario_percibido_salida,
file="inputs/Bienestar/graficos_gf_salario_percibido_salida.RDS")
salario_justo <- c("d04_01","d04_02")
names(salario_justo)<- c("Empresario","Obrero")
gf_salario_justo_perfiles <- lapply(1:length(salario_justo),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_justo[i])))%>%
stats(log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_justo[i]))})%>%
bind_rows()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Salario justo según tipo de votante")
saveRDS(gf_salario_justo_perfiles,file = "inputs/Bienestar/graficos/gf_salario_justo_perfiles.RDS")
gf_salario_justo_salida <- lapply(1:length(salario_justo),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_justo[i])))%>%
stats(log_salario,by=c(ola,salida),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_justo[i]))})%>%
bind_rows()%>%
filter(salida %in% c("Apruebo","Rechazo"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~salida)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Salario justo según voto en Plebiscito")
saveRDS(gf_salario_justo_salida,file="inputs/Bienestar/graficos/gf_salario_justo_salida.RDS")
print(readRDS("../inputs/Bienestar/graficos/gf_clase_subjetiva_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_clase_subjetiva_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_clase_subjetiva_perfiles.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_clase_subjetiva_perfiles.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_movilidad_social_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_ubicacion_social_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_ubicacion_social_perfiles.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_ahorros_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_ahorros_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_ahorros_perfiles.RDS"))
grafo_prop_var("m43","pp_4",umbral = c(3,4,5),
titulo="Grado de acuerdo según perfil de votante",
limy_sup = .60,
atricion=c(1,33),
guardar = TRUE,
guardar_como = "gf_sobrecarga_deuda_perfiles",
imprimir = FALSE)
grafo_prop_var("m43","salida",umbral = c(3,4,5),
titulo="Grado de acuerdo según votante",
limy_sup = .75,
atricion = c(1,33),
guardar = TRUE,
guardar_como = "gf_sobrecarga_deuda_salida",
imprimir = FALSE)
print(readRDS("../inputs/Bienestar/graficos/gf_sobrecarga_deuda_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_sobrecarga_deuda_perfiles.RDS"))
gf_salario_percibido_salida <-  lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,salida),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_percibido[i]))})%>%
bind_rows()%>%
filter(salida %in% c("Apruebo","Rechazo"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~salida)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según voto en Plebiscito")
saveRDS(gf_salario_percibido_salida,
file="inputs/Bienestar/graficos/gf_salario_percibido_salida.RDS")
print(readRDS("../inputs/Bienestar/graficos/gf_salario_percibido_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_salario_justo_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_salario_justo_perfiles.RDS"))
bookdown::preview_chapter()
preview_chapter()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
xaringan::inf_mr()
gf_conf_inter_perfiles <- readRDS("../inputs/Bienestar/graficos/gf_conf_inter_perfiles.RDS")
gf_conf_inter_perfiles
print(readRDS("../inputs/Bienestar/graficos/gf_meritocracia_esfuerzo_voto.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_meritocracia_esfuerzo_perfiles.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_meritocracia_inteligencia_voto.RDS"))
gf_meritocracia_inteligencia_perfiles <- readRDS("C:/RProjects/ELSOC 2022/rcs_v1/inputs/Bienestar/graficos/gf_meritocracia_inteligencia_perfiles.RDS")
rm(list=ls())
library(knitr)
library(tidyverse)
library(sjmisc)
library(sjlabelled)
library(ggrepel)
library(ggalluvial)
library(survey)
library(elsoc)
library(lubridate)
library(viridis)
library(statar)
library(bookdown)
library(knitr)
knitr::opts_chunk$set(cache=FALSE, warning=FALSE, message=FALSE, echo=FALSE, fig.topcaption = TRUE, fig.align = 'center')
Sys.setlocale("LC_ALL","ES_ES.UTF-8")
gf_conf_inter <- readRDS("../inputs/Bienestar/graficos/gf_conf_inter.RDS")
gf_conf_inter
gf_conf_inter_perfiles <- readRDS("../inputs/Bienestar/graficos/gf_conf_inter_perfiles.RDS")
gf_conf_inter_perfiles
print(readRDS("../inputs/Bienestar/graficos/gf_meritocracia_esfuerzo_voto.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_meritocracia_esfuerzo_perfiles.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_meritocracia_inteligencia_voto.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_meritocracia_inteligencia_perfiles.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_distributiva_educacion_voto.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_distributiva_educacion_perfiles.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_distributiva_salud_voto.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_distributiva_salud_perfiles.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_distributiva_pensiones_voto.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_distributiva_pensiones_perfiles.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_desigualdad_ingreso_perfiles.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_desigualdad_ingreso_voto.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_orgullo_chile_voto.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_clase_subjetiva_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_ubicacion_social_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_ubicacion_social_perfiles.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_ahorros_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_ahorros_perfiles.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_sobrecarga_deuda_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_sobrecarga_deuda_perfiles.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_salario_percibido_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_salario_percibido_perfiles.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_salario_justo_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_salario_justo_perfiles.RDS"))
xaringan::inf_mr()
# PERCEPCION SALARIOS -----------------------------------------------------
salario_percibido <- c("d03_01","d03_02")
names(salario_percibido)<- c("Empresario","Obrero")
gf_salario_percibido_perfiles <- lapply(1:length(salario_percibido),
function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33),d03_01!=0)%>%
mutate(d03_01 = ifelse(d03_01==0,1,d03_01),
d03_02 = ifelse(d03_02==0,1,d03_02)) %>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na() %>%
mutate(variable=names(salario_percibido[i]))})%>%
bind_rows()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según tipo de votante")
elsoc_bienestar<-  readRDS("inputs/Bienestar/base_bienestar.RDS")
# PERCEPCION SALARIOS -----------------------------------------------------
salario_percibido <- c("d03_01","d03_02")
names(salario_percibido)<- c("Empresario","Obrero")
gf_salario_percibido_perfiles <- lapply(1:length(salario_percibido),
function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33),d03_01!=0)%>%
mutate(d03_01 = ifelse(d03_01==0,1,d03_01),
d03_02 = ifelse(d03_02==0,1,d03_02)) %>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na() %>%
mutate(variable=names(salario_percibido[i]))})%>%
bind_rows()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según tipo de votante")
saveRDS(gf_salario_percibido_perfiles,
file="inputs/Bienestar/graficos/gf_salario_percibido_perfiles.RDS")
gf_salario_percibido_perfiles
gf_salario_percibido_salida <-  lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
mutate(d03_01 = ifelse(d03_01==0,1,d03_01),
d03_02 = ifelse(d03_02==0,1,d03_02)) %>%
filter(tipo_atricion %in% c(1,33),d03_01!=0)%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,salida),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_percibido[i]))})%>%
bind_rows()%>%
filter(salida %in% c("Apruebo","Rechazo"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~salida)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según voto en Plebiscito")
saveRDS(gf_salario_percibido_salida,
file="inputs/Bienestar/graficos_gf_salario_percibido_salida.RDS")
salario_justo <- c("d04_01","d04_02")
names(salario_justo)<- c("Empresario","Obrero")
gf_salario_justo_perfiles <- lapply(1:length(salario_justo),function(i){
elsoc_bienestar%>%
mutate(d04_01 = ifelse(d04_01==0,1,d04_01),
d04_02 = ifelse(d04_02==0,1,d04_02)) %>%
filter(tipo_atricion %in% c(1,33),d04_01!=0)%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_justo[i])))%>%
stats(log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_justo[i]))})%>%
bind_rows()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Salario justo según tipo de votante")
saveRDS(gf_salario_justo_perfiles,file = "inputs/Bienestar/graficos/gf_salario_justo_perfiles.RDS")
gf_salario_justo_salida <- lapply(1:length(salario_justo),function(i){
elsoc_bienestar%>%
mutate(d04_01 = ifelse(d04_01==0,1,d04_01),
d04_02 = ifelse(d04_02==0,1,d04_02)) %>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_justo[i])))%>%
stats(log_salario,by=c(ola,salida),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_justo[i]))})%>%
bind_rows()%>%
filter(salida %in% c("Apruebo","Rechazo"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~salida)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Salario justo según voto en Plebiscito")
gf_salario_justo_salida
saveRDS(gf_salario_justo_salida,file="inputs/Bienestar/graficos/gf_salario_justo_salida.RDS")
elsoc_bienestar<-  readRDS("inputs/Bienestar/base_bienestar.RDS")
# PERCEPCION SALARIOS -----------------------------------------------------
salario_percibido <- c("d03_01","d03_02")
names(salario_percibido)<- c("Empresario","Obrero")
gf_salario_percibido_perfiles <- lapply(1:length(salario_percibido),
function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33),d03_01!=0)%>%
mutate(d03_01 = ifelse(d03_01==0,1,d03_01),
d03_02 = ifelse(d03_02==0,1,d03_02)) %>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na() %>%
mutate(variable=names(salario_percibido[i]))})%>%
bind_rows()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según tipo de votante")
saveRDS(gf_salario_percibido_perfiles,
file="inputs/Bienestar/graficos/gf_salario_percibido_perfiles.RDS")
gf_salario_percibido_perfiles
gf_salario_percibido_salida <-  lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
mutate(d03_01 = ifelse(d03_01==0,1,d03_01),
d03_02 = ifelse(d03_02==0,1,d03_02)) %>%
filter(tipo_atricion %in% c(1,33),d03_01!=0)%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,salida),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_percibido[i]))})%>%
bind_rows()%>%
filter(salida %in% c("Apruebo","Rechazo"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~salida)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según voto en Plebiscito")
saveRDS(gf_salario_percibido_salida,
file="inputs/Bienestar/graficos_gf_salario_percibido_salida.RDS")
salario_justo <- c("d04_01","d04_02")
names(salario_justo)<- c("Empresario","Obrero")
gf_salario_justo_perfiles <- lapply(1:length(salario_justo),function(i){
elsoc_bienestar%>%
mutate(d04_01 = ifelse(d04_01==0,1,d04_01),
d04_02 = ifelse(d04_02==0,1,d04_02)) %>%
filter(tipo_atricion %in% c(1,33),d04_01!=0)%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_justo[i])))%>%
stats(log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_justo[i]))})%>%
bind_rows()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Salario justo según tipo de votante")
saveRDS(gf_salario_justo_perfiles,file = "inputs/Bienestar/graficos/gf_salario_justo_perfiles.RDS")
gf_salario_justo_salida <- lapply(1:length(salario_justo),function(i){
elsoc_bienestar%>%
mutate(d04_01 = ifelse(d04_01==0,1,d04_01),
d04_02 = ifelse(d04_02==0,1,d04_02)) %>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_justo[i])))%>%
stats(log_salario,by=c(ola,salida),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_justo[i]))})%>%
bind_rows()%>%
filter(salida %in% c("Apruebo","Rechazo"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~salida)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Salario justo según voto en Plebiscito")
gf_salario_justo_salida
saveRDS(gf_salario_justo_salida,file="inputs/Bienestar/graficos/gf_salario_justo_salida.RDS")
print(readRDS("../inputs/Bienestar/graficos/gf_salario_percibido_salida.RDS"))
print(readRDS("../inputs/Bienestar/graficos/gf_salario_percibido_salida.RDS"))
# PERCEPCION SALARIOS -----------------------------------------------------
salario_percibido <- c("d03_01","d03_02")
names(salario_percibido)<- c("Empresario","Obrero")
gf_salario_percibido_perfiles <- lapply(1:length(salario_percibido),
function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33),d03_01!=0)%>%
mutate(d03_01 = ifelse(d03_01==0,1,d03_01),
d03_02 = ifelse(d03_02==0,1,d03_02)) %>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na() %>%
mutate(variable=names(salario_percibido[i]))})%>%
bind_rows()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según tipo de votante")
saveRDS(gf_salario_justo_salida,file="inputs/Bienestar/graficos/gf_salario_justo_salida.RDS")
