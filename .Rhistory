perfiles
source("C:/RProjects/ELSOC 2022/rcs_v1/inputs/Bienestar/crear base modulo bienestar.R", echo=TRUE)
grafo_prop_var("c35_01","pp_4",umbral = c(4,5),
titulo="Grado de acuerdo según tipo de votante",
atricion=c(1,33))
library(tidyverse)
library(sjmisc)
library(sjlabelled)
library(ggrepel)
library(ggalluvial)
library(survey)
library(elsoc)
library(lubridate)
library(viridis)
elsoc_bienestar<-  readRDS("inputs/Bienestar/base_bienestar.RDS")
source("inputs/Bienestar/graficos/funcion para graficar proporciones.R")
grafo_prop_var("c35_01","pp_4",umbral = c(4,5),
titulo="Grado de acuerdo según tipo de votante",
atricion=c(1,33))
grafo_prop_var("c35_01","pp_4",umbral = c(4,5),
titulo="Grado de acuerdo según tipo de votante",
atricion=c(33))
grafo_prop_var("c35_02","pp_4",umbral = c(4,5),
titulo="Grado de acuerdo según tipo de votante",
atricion=c(33))
grafo_prop_var("c35_03","pp_4",umbral = c(4,5),
titulo="Grado de acuerdo según tipo de votante",
atricion=c(33))
lapply(1:length(trato_justo_clase), function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(33))%>%
sjlabelled::as_label(ola) %>%
stats(!!rlang::sym(vars_clase_sub[i]),by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico")%>%
mutate(variable=names(trato_justo_clase)[i])
})%>%
trato_justo_clase <- c("d25_01","d25_02","d25_03")
names(vars_clase_sub)<- c("Pobres","Clase Media","Clase Alta")
lapply(1:length(trato_justo_clase), function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(33))%>%
sjlabelled::as_label(ola) %>%
stats(!!rlang::sym(trato_justo_clase[i]),by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
mutate(variable=names(trato_justo_clase)[i])
})%>%
bind_rows()%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_point()+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
facet_wrap(~pp_4)+
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
theme(plot.caption = element_text(hjust = 0),
legend.title = element_blank(),
legend.position = "top")+
ggtitle('Ubicación en la sociedad chilena según voto en plebiscito de salida',
subtitle = "¿Dónde se ubicaría usted, sus hijos, y su familia de origen\n en la sociedad chilena?")+
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.\nPromedio en escala 0 a 10')
library(elsoc)
lapply(1:length(trato_justo_clase), function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(33))%>%
sjlabelled::as_label(ola) %>%
stats(!!rlang::sym(trato_justo_clase[i]),by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
mutate(variable=names(trato_justo_clase)[i])
})%>%
bind_rows()
lapply(1:length(trato_justo_clase), function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
stats(!!rlang::sym(trato_justo_clase[i]),by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
mutate(variable=names(trato_justo_clase)[i])
})%>%
bind_rows()
lapply(1:length(trato_justo_clase), function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
stats(!!rlang::sym(trato_justo_clase[i]),by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
mutate(variable=names(trato_justo_clase)[i])
})%>%
bind_rows()
names(trato_justo_clase)
trato_justo_clase <- c("d25_01","d25_02","d25_03")
names(trato_justo_clase)<- c("Pobres","Clase Media","Clase Alta")
lapply(1:length(trato_justo_clase), function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
stats(!!rlang::sym(trato_justo_clase[i]),by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
mutate(variable=names(trato_justo_clase)[i])
})%>%
bind_rows()%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_point()+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
facet_wrap(~pp_4)+
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
theme(plot.caption = element_text(hjust = 0),
legend.title = element_blank(),
legend.position = "top")+
ggtitle('Ubicación en la sociedad chilena según voto en plebiscito de salida',
subtitle = "¿Dónde se ubicaría usted, sus hijos, y su familia de origen\n en la sociedad chilena?")+
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.\nPromedio en escala 0 a 10')
lapply(1:length(trato_justo_clase), function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
stats(!!rlang::sym(trato_justo_clase[i]),by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
mutate(variable=names(trato_justo_clase)[i])
})%>%
bind_rows()
lapply(1:length(trato_justo_clase), function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(33))%>%
sjlabelled::as_label(ola) %>%
stats(!!rlang::sym(trato_justo_clase[i]),by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
mutate(variable=names(trato_justo_clase)[i])
})%>%
bind_rows()%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_point()+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
facet_wrap(~pp_4)+
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
theme(plot.caption = element_text(hjust = 0),
legend.title = element_blank(),
legend.position = "top")+
ggtitle('Ubicación en la sociedad chilena según voto en plebiscito de salida',
subtitle = "¿Dónde se ubicaría usted, sus hijos, y su familia de origen\n en la sociedad chilena?")+
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.\nPromedio en escala 0 a 10')
lapply(1:length(trato_justo_clase), function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(33))%>%
sjlabelled::as_label(ola) %>%
stats(!!rlang::sym(trato_justo_clase[i]),by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
mutate(variable=names(trato_justo_clase)[i])
})%>%
bind_rows()%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_point()+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
facet_wrap(~pp_4)+
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
theme(plot.caption = element_text(hjust = 0),
legend.title = element_blank(),
legend.position = "top")+
ggtitle('Ubicación en la sociedad chilena según voto en plebiscito de salida',
subtitle = "¿Dónde se ubicaría usted, sus hijos, y su familia de origen\n en la sociedad chilena?")+
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.\nPromedio en escala 0 a 10')
trato_justo_edad_sexo <- c("d25_04","d25_05","d25_06")
names(trato_justo_edad_sexo)<- c("Jóvenes","Adultos Mayores","Mujeres")
lapply(1:length(trato_justo_edad_sexo), function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(33))%>%
sjlabelled::as_label(ola) %>%
stats(!!rlang::sym(trato_justo_edad_sexo[i]),by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
mutate(variable=names(trato_justo_edad_sexo)[i])
})%>%
bind_rows()%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_point()+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
facet_wrap(~pp_4)+
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
theme(plot.caption = element_text(hjust = 0),
legend.title = element_blank(),
legend.position = "top")+
ggtitle('Ubicación en la sociedad chilena según voto en plebiscito de salida',
subtitle = "¿Dónde se ubicaría usted, sus hijos, y su familia de origen\n en la sociedad chilena?")+
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.\nPromedio en escala 0 a 10')
base_bienestar <- readRDS("C:/RProjects/ELSOC 2022/rcs_v1/inputs/Bienestar/base_bienestar.RDS")
base_bienestar$pp_3
library(tidyverse)
library(sjmisc)
library(sjlabelled)
library(ggrepel)
library(ggalluvial)
library(survey)
library(elsoc)
library(lubridate)
library(viridis)
elsoc_bienestar<-  readRDS("inputs/Bienestar/base_bienestar.RDS")
source("inputs/Bienestar/graficos/funcion para graficar proporciones.R")
grafo_prop_var("c35_01","pp_3",umbral = c(4,5),
titulo="Grado de acuerdo según tipo de votante",
atricion=c(33))
grafo_prop_var("c35_02","pp_3",umbral = c(4,5),
titulo="Grado de acuerdo según tipo de votante",
atricion=c(33))
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(4,5)))%>%
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(4,5))%>%
prop_list(valor,by=c(ola,na.rm=TRUE)%>%
filter(value==1)%>%
drop_na()
elsoc_bienestar%>%
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(4,5))
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(4,5))%>%
prop_list(valor,by=c(ola,na.rm=TRUE))%>%
filter(value==1)%>%
drop_na()
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(4,5))%>%
prop(valor,by=c(ola),na.rm=TRUE)%>%
filter(value==1)%>%
drop_na()
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(4,5))%>%
prop_list(valor,by=c(ola),na.rm=TRUE)%>%
filter(value==1)
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(4,5))%>%
prop_list(valor,by=c(ola),na.rm=TRUE)
sjmisc::frq(elsoc_bienestar$c02)
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(1))%>%
prop_list(valor,by=c(ola),na.rm=TRUE)
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(1))%>%
prop_list(valor,by=c(ola),na.rm=TRUE)%>%
mutate(valor=as.numeric(value))%>%
filter(value==1)%>%
drop_na()
elsoc_bienestar%>%
filter(tipo_atricion %in% c(33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(1))%>%
prop_list(valor,by=c(ola),na.rm=TRUE)%>%
mutate(valor=as.numeric(value))%>%
filter(value==1)%>%
drop_na()
elsoc_bienestar%>%
filter(tipo_atricion %in% c(33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(1))%>%
prop_list(valor,by=c(ola),na.rm=TRUE)%>%
mutate(valor=as.numeric(value))%>%
filter(value==1)%>%
drop_na()%>%
ggplot(aes(x=factor(ola),y=prop,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()
elsoc_bienestar%>%
filter(tipo_atricion %in% c(33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(1))%>%
prop_list(valor,by=c(ola),na.rm=TRUE)%>%
mutate(valor=as.numeric(value))%>%
filter(value==1)%>%
drop_na()%>%
ggplot(aes(x=factor(ola),y=prop, group=value,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(1))%>%
prop_list(valor,by=c(ola),na.rm=TRUE)%>%
mutate(valor=as.numeric(value))%>%
filter(value==1)%>%
drop_na()%>%
ggplot(aes(x=factor(ola),y=prop, group=value,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(1))%>%
prop_list(valor,by=c(ola),na.rm=TRUE)%>%
mutate(valor=as.numeric(value))%>%
filter(value==1)%>%
drop_na()%>%
ggplot(aes(x=factor(ola),y=prop, group=value,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
scale_y_continuous(labels = scales::percent, limits = c(limy_low,limy_sup))+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(1))%>%
prop_list(valor,by=c(ola),na.rm=TRUE)%>%
mutate(valor=as.numeric(value))%>%
filter(value==1)%>%
drop_na()%>%
ggplot(aes(x=factor(ola),y=prop, group=value,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
scale_y_continuous(labels = scales::percent, limits = c(0,.5))+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(1))%>%
prop_list(valor,by=c(ola),na.rm=TRUE)%>%
mutate(valor=as.numeric(value))%>%
filter(value==1)%>%
drop_na()%>%
ggplot(aes(x=factor(ola),y=prop, group=value,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
scale_y_continuous(labels = scales::percent, limits = c(0,.5))+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle(titulo,
subtitle = gsub(x=attr(getElement(elsoc_bienestar,"c02"),"label"),
pattern = "Grado de acuerdo: ",
replacement = ""))+
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(1))%>%
prop_list(valor,by=c(ola),na.rm=TRUE)%>%
mutate(valor=as.numeric(value))%>%
filter(value==1)%>%
drop_na()%>%
ggplot(aes(x=factor(ola),y=prop, group=value,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
scale_y_continuous(labels = scales::percent, limits = c(0,.5))+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Evolución Confianza Interpersonal",
subtitle = gsub(x=attr(getElement(elsoc_bienestar,"c02"),"label"),
pattern = "Grado de acuerdo: ",
replacement = ""))+
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
attr(elsoc_bienestar$c02,"label")<- "Se puede confiar en las personas"
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(1))%>%
prop_list(valor,by=c(ola),na.rm=TRUE)%>%
mutate(valor=as.numeric(value))%>%
filter(value==1)%>%
drop_na()%>%
ggplot(aes(x=factor(ola),y=prop, group=value,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
scale_y_continuous(labels = scales::percent, limits = c(0,.5))+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Grado de acuerdo por ola",
subtitle = gsub(x=attr(getElement(elsoc_bienestar,"c02"),"label"),
pattern = "Grado de acuerdo: ",
replacement = ""))+
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
grafo_prop_ola <- function(var_x){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1,33))%>%
sjlabelled::as_label(ola) %>%
mutate(valor= c02 %in% c(1))%>%
prop_list(valor,by=c(ola),na.rm=TRUE)%>%
mutate(valor=as.numeric(value))%>%
filter(value==1)%>%
drop_na()%>%
ggplot(aes(x=factor(ola),y=prop, group=value,
label = scales::percent(prop, accuracy = .1)))+
geom_point()+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
scale_y_continuous(labels = scales::percent, limits = c(0,.5))+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Grado de acuerdo por ola",
subtitle = gsub(x=attr(getElement(elsoc_bienestar,"c02"),"label"),
pattern = "Grado de acuerdo: ",
replacement = ""))+
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
}
grafo_prop_ola()
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
sjmisc::frq(elsoc_bienestar$c03)
source("~/.active-rstudio-document", echo=TRUE)
# ALTRUISMO SOCIAL GENERALIZADO
attr(elsoc_bienestar$c03,"label")<- "Las personas tratan de ayudar a los demás"
### EVOLUCION GENERAL
grafo_prop_ola("c03",c(1,33),1,"Grado de acuerdo por ola")
grafo_prop_var("c02","pp_3","Grado de acuerdo según voto en plebiscito",
umbral = 1,
limy_sup = .5,
atricion = c(1,33))
source("C:/RProjects/ELSOC 2022/rcs_v1/inputs/Bienestar/crear base modulo bienestar.R", echo=TRUE)
# ALTRUISMO SOCIAL GENERALIZADO
attr(elsoc_bienestar$c03,"label")<- "Las personas tratan de ayudar a los demás"
### EVOLUCION GENERAL
grafo_prop_ola("c03",c(1,33),1,"Grado de acuerdo por ola")
grafo_prop_var("c03","pp_3","Grado de acuerdo según voto en plebiscito",
umbral = 1,
atricion = c(1,33),
limy_sup = .5)
elsoc_bienestar<-  readRDS("inputs/Bienestar/base_bienestar.RDS")
grafo_prop_var("c03","pp_3","Grado de acuerdo según voto en plebiscito",
umbral = 1,
atricion = c(1,33),
limy_sup = .5)
