filter(muestra==1,tipo_atricion==1,!is.na(sit_laboral)) %>%
prop(sit_laboral=="Ocupados", by = c(ola,m0_sexo), na.rm = TRUE) %>%
sjlabelled::as_label(sit_laboral, m0_sexo) %>%
ggplot(aes(y = prop, x = ola, color = m0_sexo, group = m0_sexo,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(nudge_y = .025, size = 3, color = 'black') +
scale_y_continuous(labels = scales::percent, limits = 0:1) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = .33, end = .66) +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos"))) %>%
filter(muestra==1,tipo_atricion==1,!is.na(sit_laboral)) %>%
prop(sit_laboral, by = c(ola,m0_sexo), na.rm = TRUE) %>%
sjlabelled::as_label(sit_laboral, m0_sexo) %>%
ggplot(aes(y = prop, x = ola, color = m0_sexo, group = m0_sexo,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(nudge_y = .025, size = 3, color = 'black') +
scale_y_continuous(labels = scales::percent, limits = 0:1) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = .33, end = .66) +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
# elsoc::load_elsoc('long')
elsoc_long_2016_2022 %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos"))) %>%
filter(muestra==1,tipo_atricion==1,!is.na(sit_laboral)) %>%
prop(sit_laboral, by = c(ola,m0_sexo), na.rm = TRUE) %>%
sjlabelled::as_label(sit_laboral, m0_sexo) %>%
ggplot(aes(y = prop, x = ola, color = m0_sexo, group = m0_sexo,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(nudge_y = .025, size = 3, color = 'black') +
scale_y_continuous(labels = scales::percent, limits = 0:1) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = .33, end = .66) +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
# elsoc::load_elsoc('long')
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos"))) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral==1', 'sit_laboral==2', 'sit_laboral==3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos'))) %>%
ggplot(aes(y = prop, x = ola, group = name, color = name,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(nudge_y = .025, size = 3, color = 'black') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle(NULL, 'Porcentaje que responde que...') +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
# elsoc::load_elsoc('long')
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos"))) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral==1', 'sit_laboral==2', 'sit_laboral==3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos'))) %>%
ggplot(aes(y = prop, x = ola, group = name, color = name,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(nudge_y = .025, size = 3, color = 'black') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle(NULL, 'Situación Laboral por Ola') +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
# elsoc::load_elsoc('long')
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos")))
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos")))
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos")))
& !is_nsnr(m02)
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos")))
View(p)
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3))
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral==1', 'sit_laboral==2', 'sit_laboral==3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos'))) %>%
ggplot(aes(y = prop, x = ola, group = name, color = name,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(nudge_y = .025, size = 3, color = 'black') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle(NULL, 'Situación Laboral por Ola') +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
p
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral==1', 'sit_laboral==2', 'sit_laboral==3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos'))) %>%
ggplot(aes(y = prop, x = ola, group = name, color = name,
label = scales::percent(prop, accuracy = .1)))
p
p
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral==1', 'sit_laboral==2', 'sit_laboral==3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos'))) %>%
ggplot(aes(y = prop, x = ola, group = name, color = name,
label = scales::percent(prop, accuracy = .1))) + theme_bw
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral==1', 'sit_laboral==2', 'sit_laboral==3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos'))) %>%
ggplot(aes(y = prop, x = ola, group = name, color = name,
label = scales::percent(prop, accuracy = .1)))
p + geom_point()
p + geom_point() + geom_line()
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral==1', 'sit_laboral==2', 'sit_laboral==3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos'))) %>%
ggplot(aes(y = prop, x = ola, group = name, color = name,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(nudge_y = .025, size = 3, color = 'black') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle(NULL, 'Situación Laboral por Ola') +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
p
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(s01, s02, s03)) %>%
sjlabelled::as_label(ola) %>%
prop_list(s01 %in% 4:5, s02 %in% 4:5, s03 %in% 4:5, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('s01 %in% 4:5', 's02 %in% 4:5', 's03 %in% 4:5'),
labels = c('Esta satisfecho o muy\nsatisfecho con su vida',
'Su vida se acerca o se acerca\ncompletamente a su ideal',
'Su salud es muy buena\no Excelente'))) %>%
ggplot(aes(y = prop, x = ola, group = name, color = name,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(nudge_y = .025, size = 3, color = 'black') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle(NULL, 'Porcentaje que responde que...') +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
elsoc_long_2016_2022 %>%
purrr::map_at(.at = vars(starts_with('s11_0')),
.f = function(s) car::recode(s, "1 = 0; 2 = 1; 3 = 2; c(4, 5) = 3; c(-888, -999) = NA")) %>%
as.data.frame() %>%
mutate(phq9 = (s11_01 + s11_02 + s11_03 + s11_04 + s11_05 + s11_06 + s11_07 + s11_08 + s11_09)) %>%
dplyr::filter(tipo_atricion == 1) %>%
prop(phq9 >= 10 , by = c(ola, m0_sexo), na.rm = TRUE) %>%
sjlabelled::as_label(ola, m0_sexo) %>%
ggplot(aes(y = prop, x = ola, color = m0_sexo, group = m0_sexo,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(nudge_y = .025, size = 3, color = 'black') +
scale_y_continuous(labels = scales::percent, limits = 0:1) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = .33, end = .66) +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral==1', 'sit_laboral==2', 'sit_laboral==3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos')))
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral==1', 'sit_laboral==2', 'sit_laboral==3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos')))
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral==1', 'sit_laboral==2', 'sit_laboral==3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos')))
View(p)
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(s01, s02, s03)) %>%
sjlabelled::as_label(ola) %>%
prop_list(s01 %in% 4:5, s02 %in% 4:5, s03 %in% 4:5, by = ola, na.rm = TRUE)
(elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(s01, s02, s03)) %>%
sjlabelled::as_label(ola) %>%
prop_list(s01 %in% 4:5, s02 %in% 4:5, s03 %in% 4:5, by = ola, na.rm = TRUE))$name
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral==1', 'sit_laboral==2', 'sit_laboral==3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos'))) %>%
ggplot(aes(y = prop, x = ola, group = name, color = name,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(nudge_y = .025, size = 3, color = 'black') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle(NULL, 'Situación Laboral por Ola') +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
p
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE)
p$name
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral==1', 'sit_laboral==2', 'sit_laboral==3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos'))) %>%
ggplot(aes(y = prop, x = ola, group = name, color = name,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(nudge_y = .025, size = 3, color = 'black') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle(NULL, 'Situación Laboral por Ola') +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
p
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral==1', 'sit_laboral==2', 'sit_laboral==3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos')))
p$name
p$name
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE)
p$name
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral == 1', 'sit_laboral == 2', 'sit_laboral == 3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos')))
p$name
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1 & !is_nsnr(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral == 1', 'sit_laboral == 2', 'sit_laboral == 3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos'))) %>%
ggplot(aes(y = prop, x = ola, group = name, color = name,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(nudge_y = .025, size = 3, color = 'black') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle(NULL, 'Situación Laboral por Ola') +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
p
?facet_grid
p = elsoc_long_2016_2022 %>%
mutate(salida = factor(car::recode(salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos")),
ola = ifelse(ola==1,"2016",
ifelse(ola==6,"2022",ola))) %>%
filter(ola==1|ola==6,muestra==1,!is.na(salida),!is.na(sit_laboral)) %>%
prop(salida, by = c(ola,sit_laboral), na.rm = TRUE) %>%
sjlabelled::as_label(salida, sit_laboral) %>%
ggplot(aes(y = prop, x = sit_laboral, fill = fct_rev(salida),
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_col(position = 'Stack')
p = elsoc_long_2016_2022 %>%
mutate(salida = factor(car::recode(salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos")),
ola = ifelse(ola==1,"2016",
ifelse(ola==6,"2022",ola))) %>%
filter(ola==2016|ola==2022,muestra==1,!is.na(salida),!is.na(sit_laboral)) %>%
prop(salida, by = c(ola,sit_laboral), na.rm = TRUE) %>%
sjlabelled::as_label(salida, sit_laboral) %>%
ggplot(aes(y = prop, x = sit_laboral, fill = fct_rev(salida),
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_col(position = 'Stack')
p +
scale_y_continuous(labels = scales::percent) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(begin = 0, end = .85, option = 'viridis') +
geom_text(position = position_stack(vjust = .5),
size = 3) +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
guides(fill = guide_legend(reverse = TRUE)) +
facet_grid(~ola) +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
