stats(!!rlang::sym(vars_clase_sub[i]),by=c(ola,salida),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
filter(salida!="Otros")%>%
mutate(variable=names(vars_clase_sub)[i])
})
data
data<- lapply(1:length(vars_clase_sub), function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
stats(!!rlang::sym(vars_clase_sub[i]),by=c(ola,salida),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
filter(salida!="Otros")%>%
mutate(variable=names(vars_clase_sub)[i])
})%>%
bind_rows()
data
data%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable))+
geom_point()+
geom_line()+
geom_point()+
facet_wrap(~salida)
data%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable))+
geom_point()+
geom_line()+
geom_point()+
facet_wrap(~salida)+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
facet_wrap(~salida)+
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')
data%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(prop,2)))+
geom_point()+
geom_line()+
geom_point()+
facet_wrap(~salida)+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
facet_wrap(~salida)+
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')
data%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_point()+
geom_line()+
geom_point()+
facet_wrap(~salida)+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
facet_wrap(~salida)+
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')
data%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_point()+
geom_line()+
geom_point()+
facet_wrap(~salida)+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
facet_wrap(~salida)+
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
theme(plot.caption = element_text(hjust = 0),
legend.title = element_blank())
data%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_point()+
geom_line()+
geom_point()+
facet_wrap(~salida)+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
facet_wrap(~salida)+
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
theme(plot.caption = element_text(hjust = 0),
legend.title = element_blank(),
legend.position = "top")+
ggtitle('Ubicación en la sociedad chilena según voto en plebiscito de salida')+
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
elsoc_bienestar%>%
filter(tipo_atricion %in% c(33))%>%
sjlabelled::as_label(ola) %>%
prop_list(clase_sub,by=c(ola,salida),na.rm=TRUE)%>%
drop_na()%>%
filter(salida != "Otros")%>%
ggplot(aes(x=ola,y=prop,color=value,group=value,
label = scales::percent(prop, accuracy = .1)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
facet_wrap(~salida)+
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
scale_y_continuous(labels = scales::percent)+
theme(plot.caption = element_text(hjust = 0),
legend.title = element_blank())+
ggtitle('Clase social subjetiva, según voto en plebiscito de salida')+
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
elsoc_bienestar%>%
filter(tipo_atricion %in% c(33))%>%
sjlabelled::as_label(ola) %>%
prop_list(clase_sub,by=c(ola,salida),na.rm=TRUE)%>%
drop_na()%>%
filter(salida != "Otros")%>%
ggplot(aes(x=ola,y=prop,color=value,group=value,
label = scales::percent(prop, accuracy = .1)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
facet_wrap(~salida)+
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
scale_y_continuous(labels = scales::percent)+
theme(plot.caption = element_text(hjust = 0),
legend.title = element_blank(),
legend.position = "top")+
ggtitle('Clase social subjetiva, según voto en plebiscito de salida')+
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
lapply(1:length(vars_clase_sub), function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
stats(!!rlang::sym(vars_clase_sub[i]),by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
#    filter(salida!="Otros")%>%
mutate(variable=names(vars_clase_sub)[i])
})
lapply(1:length(vars_clase_sub), function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
stats(!!rlang::sym(vars_clase_sub[i]),by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico" ))%>%
mutate(variable=names(vars_clase_sub)[i])
})%>%
bind_rows()
lapply(1:length(vars_clase_sub), function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
stats(!!rlang::sym(vars_clase_sub[i]),by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico" ))%>%
mutate(variable=names(vars_clase_sub)[i])
})%>%
bind_rows()%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_point()+
geom_line()+
geom_point()+
facet_wrap(~pp_4)+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
theme(plot.caption = element_text(hjust = 0),
legend.title = element_blank(),
legend.position = "top")+
ggtitle('Ubicación en la sociedad chilena según perfil de voto')+
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario_empresario=log(d03_01))
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario_empresario=log(d03_01),
log_salario_obrero=log(d03_02))
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario_empresario=log(d03_01),
log_salario_obrero=log(d03_02),
dif_log_salarios= log_salario_empresario-log_salario_obrero)
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario_empresario=log(d03_01),
log_salario_obrero=log(d03_02),
dif_log_salarios= log_salario_empresario-log_salario_obrero)%>%
stats(dif_log_salarios,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario_empresario=log(d03_01),
log_salario_obrero=log(d03_02),
dif_log_salarios= log_salario_empresario-log_salario_obrero)%>%
stats(dif_log_salarios,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
ggplot(aes(x=ola,y=stat,group=pp_4,color=pp_4))+
geom_line()+
geom_point()
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario_justo_empresario=log(d03_01),
log_salario_justo_obrero=log(d03_02),
dif_log_justo_salarios= log_salario_justo_empresario-log_salario_justo_obrero)%>%
stats(dif_log_salarios,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
ggplot(aes(x=ola,y=stat,group=pp_4,color=pp_4))+
geom_line()+
geom_point()
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario_justo_empresario=log(d03_01),
log_salario_justo_obrero=log(d03_02),
dif_log_salario_justo= log_salario_justo_empresario-log_salario_justo_obrero)%>%
stats(dif_log_salario_justo,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
ggplot(aes(x=ola,y=stat,group=pp_4,color=pp_4))+
geom_line()+
geom_point()
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario_justo_empresario=log(d04_01),
log_salario_justo_obrero=log(d04_02),
dif_log_salario_justo= log_salario_justo_empresario-log_salario_justo_obrero)%>%
stats(dif_log_salario_justo,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
ggplot(aes(x=ola,y=stat,group=pp_4,color=pp_4))+
geom_line()+
geom_point()
lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(rlang::sym(salario_percibido[i])))%>%
stats(dif_log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()
})
salario_percibido <- c("d04_01","d04_02")
names(salario_percibido)<- c("Empresario","Obrero")
lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(rlang::sym(salario_percibido[i])))%>%
stats(dif_log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()
})
lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(dif_log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()
})
lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()
})
lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_percibido[i]))
})
datos<- lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_percibido[i]))
})%>%
bind_rows()
datos%>%
ggplot(x=ola,y=stat,color=variable,group=variable)+
geom_line()
datos%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable))+
geom_line()
datos%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable))+
geom_line()+
facet_wrap(~variable)
datos
rm(data)
datos%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable))+
geom_line()+
facet_wrap(~pp_4)
datos%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,labels=stat))+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)
datos%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=stat))+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)
datos%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)
datos%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según tipo de votante")
datos%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según tipo de votante")
lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,salida),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_percibido[i]))})%>%
bind_rows()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~salida)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según voto en Plebiscito")
lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,salida),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_percibido[i]))})%>%
bind_rows()%>%
filter(salida %in% c("Apruebo","Rechazo"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~salida)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según voto en Plebiscito")
salario_percibido <- c("d03_01","d03_02")
names(salario_percibido)<- c("Empresario","Obrero")
lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_percibido[i]))})%>%
bind_rows()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según tipo de votante")
lapply(1:length(salario_percibido),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_percibido[i])))%>%
stats(log_salario,by=c(ola,salida),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_percibido[i]))})%>%
bind_rows()%>%
filter(salida %in% c("Apruebo","Rechazo"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~salida)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Percepcion salario según voto en Plebiscito")
salario_justo <- c("d04_01","d04_02")
names(salario_justo)<- c("Empresario","Obrero")
lapply(1:length(salario_justo),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_justo[i])))%>%
stats(log_salario,by=c(ola,pp_4),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_justo[i]))})%>%
bind_rows()%>%
filter(pp_4 %in% c("Votante\nCrónico","No-Votante\nCrónico"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~pp_4)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Salario justo según tipo de votante")
lapply(1:length(salario_justo),function(i){
elsoc_bienestar%>%
filter(tipo_atricion %in% c(1))%>%
sjlabelled::as_label(ola) %>%
mutate(log_salario=log(!!rlang::sym(salario_justo[i])))%>%
stats(log_salario,by=c(ola,salida),stat="mean",na.rm=TRUE)%>%
drop_na()%>%
mutate(variable=names(salario_justo[i]))})%>%
bind_rows()%>%
filter(salida %in% c("Apruebo","Rechazo"))%>%
ggplot(aes(x=ola,y=stat,color=variable,group=variable,label=round(stat,2)))+
geom_line()+
geom_point()+
geom_text_repel(nudge_y = .01, size = 3, color = 'black') +
theme_bw()+
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = 0, end = .85, option = 'viridis')+
facet_wrap(~salida)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())+
ggtitle("Salario justo según voto en Plebiscito")
