legend.title = element_blank())#+
facet_wrap(~pp_3)
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c07_05,pp_3),c07_05>0) %>%
drop_na(pp_3) %>%
mutate(c07_05_1 = ifelse(c07_05==3,1,0),
c07_05 = factor(car::recode(c07_05, "1 = 1; 2 = 2; 3 = 3"),
levels = 1:3,
labels = c('Nunca lo hizo', 'Lo hizo una o dos veces', 'Lo hizo más de dos veces'))) %>%
sjlabelled::as_label(ola) %>%
prop(x = c07_05_1 %in% c(1), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Donación de dinero a caridad, según tipo de votante',
subtitle = 'Frecuencia: Donó dinero a caridad \nLo hizo más de dos veces') +
scale_y_continuous(labels = scales::percent,
limits = c(0,.6)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c07_07,pp_3),c07_07>0) %>%
drop_na(pp_3) %>%
mutate(c07_07_1 = ifelse(c07_07==3,1,0),
c07_07 = factor(car::recode(c07_07, "1 = 1; 2 = 2; 3 = 3"),
levels = 1:3,
labels = c('Nunca lo hizo', 'Lo hizo una o dos veces', 'Lo hizo más de dos veces'))) %>%
sjlabelled::as_label(ola) %>%
prop(x = c07_07_1 %in% c(1), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Conversaciones con personas deprimidas, según perfil de votante',
subtitle = 'Frecuencia: Conversó con una persona deprimida \nLo hizo más de dos veces') +
scale_y_continuous(labels = scales::percent,
limits = c(0.4, .7)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())#+
facet_wrap(~pp_3)
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c07_08,pp_3),c07_08>0) %>%
drop_na(pp_3) %>%
mutate(c07_08_1 = ifelse(c07_08==3,1,0),
c07_08 = factor(car::recode(c07_08, "1 = 1; 2 = 2; 3 = 3"),
levels = 1:3,
labels = c('Nunca lo hizo', 'Lo hizo una o dos veces', 'Lo hizo más de dos veces'))) %>%
sjlabelled::as_label(ola) %>%
prop(x = c07_08_1 %in% c(1), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Ayuda a conseguir trabajo, según perfil de votante',
subtitle = 'Frecuencia: Ayudó a conseguir trabajo \nLo hizo más de dos veces') +
scale_y_continuous(labels = scales::percent,
limits = c(.2,.5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())#+
facet_wrap(~pp_3)
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c07_08,pp_3),c07_08>0) %>%
drop_na(pp_3) %>%
mutate(c07_08_1 = ifelse(c07_08==3,1,0),
c07_08 = factor(car::recode(c07_08, "1 = 1; 2 = 2; 3 = 3"),
levels = 1:3,
labels = c('Nunca lo hizo', 'Lo hizo una o dos veces', 'Lo hizo más de dos veces'))) %>%
sjlabelled::as_label(ola) %>%
prop(x = c07_08_1 %in% c(1), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Ayuda a conseguir trabajo, según perfil de votante',
subtitle = 'Frecuencia: Ayudó a conseguir trabajo \nLo hizo más de dos veces') +
scale_y_continuous(labels = scales::percent,
limits = c(.2,.5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c07_07,pp_3),c07_07>0) %>%
drop_na(pp_3) %>%
mutate(c07_07_1 = ifelse(c07_07==3,1,0),
c07_07 = factor(car::recode(c07_07, "1 = 1; 2 = 2; 3 = 3"),
levels = 1:3,
labels = c('Nunca lo hizo', 'Lo hizo una o dos veces', 'Lo hizo más de dos veces'))) %>%
sjlabelled::as_label(ola) %>%
prop(x = c07_07_1 %in% c(1), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Conversaciones con personas deprimidas, según perfil de votante',
subtitle = 'Frecuencia: Conversó con una persona deprimida \nLo hizo más de dos veces') +
scale_y_continuous(labels = scales::percent,
limits = c(0.4, .7)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c07_06,pp_3),c07_06>0) %>%
drop_na(pp_3) %>%
mutate(c07_06_1 = ifelse(c07_06==1,1,0),
c07_06 = factor(car::recode(c07_06, "1 = 1; 2 = 2; 3 = 3"),
levels = 1:3,
labels = c('Nunca lo hizo', 'Lo hizo una o dos veces', 'Lo hizo más de dos veces'))
) %>%
sjlabelled::as_label(ola) %>%
prop(x = c07_06_1 %in% c(1), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Prestación de dinero, según perfil de votante',
subtitle = 'Frecuencia: Presto $10,000 o más \nNunca lo hizo') +
scale_y_continuous(labels = scales::percent,
limits = c(0, .4)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())#+
facet_wrap(~pp_3)
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c07_06,pp_3),c07_06>0) %>%
drop_na(pp_3) %>%
mutate(c07_06_1 = ifelse(c07_06==1,1,0),
c07_06 = factor(car::recode(c07_06, "1 = 1; 2 = 2; 3 = 3"),
levels = 1:3,
labels = c('Nunca lo hizo', 'Lo hizo una o dos veces', 'Lo hizo más de dos veces'))
) %>%
sjlabelled::as_label(ola) %>%
prop(x = c07_06_1 %in% c(1), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Prestación de dinero, según perfil de votante',
subtitle = 'Frecuencia: Presto $10,000 o más \nNunca lo hizo') +
scale_y_continuous(labels = scales::percent,
limits = c(0, .4)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1, !is_nsnr(c18_09)) %>%
mutate(c18_09 = factor(car::recode(c18_09, "1:2 = 1; 3 = 2; 4:5 = 3"),
levels = 1:3,
labels = c('Totalmente en desacuerdo\no en desacuerdo', 'Ni de acuerdo ni\nen desacuerdo', 'De acuerdo o Totalmente\nde acuerdo'))) %>%
sjlabelled::as_label(ola) %>%
prop(x = c18_09, by = ola, na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, fill = c18_09,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_col(position = 'Stack') +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .85) +
ggtitle(label = 'Cree en la meritocracia (esfuerzo)', subtitle = 'En Chile las personas son recompensadas por sus esfuerzos') +
guides(fill = guide_legend(reverse = TRUE)) +
geom_text(position = position_stack(vjust = .5),
size = 3)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c18_09,pp_3)) %>%
drop_na(pp_3) %>%
mutate( c18_09_1 = ifelse(c18_09 %in% c(4:5),'De acuerdo o Totalmente de acuerdo',
ifelse(c18_09 %in% c(1:3),'',NA)),
c18_09_3 = factor(car::recode(c18_09, "1:2 = 1; 3 = 2; 4:5 = 3"),
levels = 1:3,
labels = c('Totalmente en desacuerdo\no en desacuerdo', 'Ni de acuerdo ni\nen desacuerdo', 'De acuerdo o Totalmente\nde acuerdo')),
) %>%
sjlabelled::as_label(ola) %>%
prop(x = c18_09 %in% c(4:5), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Creencias en la meritocracia (esfuerzo), según ola', subtitle = 'En Chile las personas son recompensadas por sus esfuerzos \n De acuerdo o Totalmente de acuerdo') +
scale_y_continuous(labels = scales::percent,
limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) #+
facet_wrap(~pp_3)
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c18_09,pp_3)) %>%
drop_na(pp_3) %>%
mutate( c18_09_1 = ifelse(c18_09 %in% c(4:5),'De acuerdo o Totalmente de acuerdo',
ifelse(c18_09 %in% c(1:3),'',NA)),
c18_09_3 = factor(car::recode(c18_09, "1:2 = 1; 3 = 2; 4:5 = 3"),
levels = 1:3,
labels = c('Totalmente en desacuerdo\no en desacuerdo', 'Ni de acuerdo ni\nen desacuerdo', 'De acuerdo o Totalmente\nde acuerdo')),
) %>%
sjlabelled::as_label(ola) %>%
prop(x = c18_09 %in% c(4:5), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Creencias en la meritocracia (esfuerzo), según ola', subtitle = 'En Chile las personas son recompensadas por sus esfuerzos \n De acuerdo o Totalmente de acuerdo') +
scale_y_continuous(labels = scales::percent,
limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c18_09,pp_3)) %>%
drop_na(pp_3) %>%
mutate( c18_09_1 = ifelse(c18_09 %in% c(4:5),'De acuerdo o Totalmente de acuerdo',
ifelse(c18_09 %in% c(1:3),'',NA)),
c18_09_3 = factor(car::recode(c18_09, "1:2 = 1; 3 = 2; 4:5 = 3"),
levels = 1:3,
labels = c('Totalmente en desacuerdo\no en desacuerdo', 'Ni de acuerdo ni\nen desacuerdo', 'De acuerdo o Totalmente\nde acuerdo')),
) %>%
sjlabelled::as_label(ola) %>%
prop(x = c18_09 %in% c(4:5), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Creencias en la meritocracia (esfuerzo), según ola', subtitle = 'En Chile las personas son recompensadas por sus esfuerzos \nDe acuerdo o Totalmente de acuerdo') +
scale_y_continuous(labels = scales::percent,
limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1, !is_nsnr(c18_10)) %>%
mutate(c18_10 = factor(car::recode(c18_10, "1:2 = 1; 3 = 2; 4:5 = 3"),
levels = 1:3,
labels = c('Totalmente en desacuerdo\no en desacuerdo', 'Ni de acuerdo ni\nen desacuerdo', 'De acuerdo o Totalmente\nde acuerdo'))) %>%
sjlabelled::as_label(ola) %>%
prop(x = c18_10, by = ola, na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, fill = c18_10,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_col(position = 'Stack') +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .85) +
ggtitle(label = 'Creencias en la meritocracia (inteligencia), según votante', subtitle = 'En Chile las personas son recompensadas por su inteligencia') +
guides(fill = guide_legend(reverse = TRUE)) +
geom_text(position = position_stack(vjust = .5),
size = 3)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1, !is_nsnr(c18_10)) %>%
mutate(c18_10 = factor(car::recode(c18_10, "1:2 = 1; 3 = 2; 4:5 = 3"),
levels = 1:3,
labels = c('Totalmente en desacuerdo\no en desacuerdo', 'Ni de acuerdo ni\nen desacuerdo', 'De acuerdo o Totalmente\nde acuerdo'))) %>%
sjlabelled::as_label(ola) %>%
prop(x = c18_10, by = ola, na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, fill = c18_10,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_col(position = 'Stack') +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .85) +
ggtitle(label = 'Creencias en la meritocracia (inteligencia), según ola', subtitle = 'En Chile las personas son recompensadas por su inteligencia') +
guides(fill = guide_legend(reverse = TRUE)) +
geom_text(position = position_stack(vjust = .5),
size = 3)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c18_10,pp_3)) %>%
drop_na(pp_3) %>%
mutate( c18_10_1 = ifelse(c18_10 %in% c(4:5),'De acuerdo o Totalmente de acuerdo',
ifelse(c18_10 %in% c(1:3),'',NA)),
c18_10_3 = factor(car::recode(c18_10, "1:2 = 1; 3 = 2; 4:5 = 3"),
levels = 1:3,
labels = c('Totalmente en desacuerdo\no en desacuerdo', 'Ni de acuerdo ni\nen desacuerdo', 'De acuerdo o Totalmente\nde acuerdo')),
) %>%
sjlabelled::as_label(ola) %>%
prop(x = c18_10 %in% c(4:5), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Creencias en la meritocracia (inteligencia), según votante', subtitle = 'En Chile las personas son recompensadas por su inteligencia \nDe acuerdo o Totalmente de acuerdo') +
scale_y_continuous(labels = scales::percent,
limits = c(0, .5)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) #+
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1, !is_nsnr(c32_01)) %>%
mutate(c32_01 = factor(car::recode(c32_01, "1:2 = 1; 3 = 2; 4:5 = 3"),
levels = 1:3,
labels = c('Totalmente en desacuerdo\no en desacuerdo', 'Ni de acuerdo ni\nen desacuerdo', 'De acuerdo o Totalmente\nde acuerdo'))) %>%
sjlabelled::as_label(ola) %>%
prop(x = c32_01, by = ola, na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, fill = c32_01,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_col(position = 'Stack') +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .85) +
ggtitle(label = 'Grado de acuerdo con: \n"Me siento orgulloso de ser chileno", según ola') +
guides(fill = guide_legend(reverse = TRUE)) +
geom_text(position = position_stack(vjust = .5),
size = 3)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1, !is_nsnr(c32_01)) %>%
mutate(c32_01 = factor(car::recode(c32_01, "1:2 = 1; 3 = 2; 4:5 = 3"),
levels = 1:3,
labels = c('Totalmente en desacuerdo\no en desacuerdo', 'Ni de acuerdo ni\nen desacuerdo', 'De acuerdo o Totalmente\nde acuerdo'))) %>%
sjlabelled::as_label(ola) %>%
prop(x = c32_01, by = ola, na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, fill = c32_01,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_col(position = 'Stack') +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(end = .85) +
ggtitle(label = 'Orgullo de ser chileno, según ola', subtitle = 'Me siento orgulloso de ser chileno') +
guides(fill = guide_legend(reverse = TRUE)) +
geom_text(position = position_stack(vjust = .5),
size = 3)+
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c32_01,pp_3)) %>%
drop_na(pp_3) %>%
mutate( c32_01_1 = ifelse(c32_01 %in% c(4:5),'De acuerdo o Totalmente de acuerdo',
ifelse(c32_01 %in% c(1:3),'',NA)),
c32_01_3 = factor(car::recode(c32_01, "1:2 = 1; 3 = 2; 4:5 = 3"),
levels = 1:3,
labels = c('Totalmente en desacuerdo\no en desacuerdo', 'Ni de acuerdo ni\nen desacuerdo', 'De acuerdo o Totalmente\nde acuerdo'))
) %>%
sjlabelled::as_label(ola) %>%
prop(x = c32_01 %in% c(4:5), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Orgullo de ser chileno, según ola', subtitle = 'Me siento orgulloso de ser chileno \nDe acuerdo o Totalmente de acuerdo') +
scale_y_continuous(labels = scales::percent,
limits = c(.75, 1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) #+
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c32_01,pp_3)) %>%
drop_na(pp_3) %>%
mutate( c32_01_1 = ifelse(c32_01 %in% c(4:5),'De acuerdo o Totalmente de acuerdo',
ifelse(c32_01 %in% c(1:3),'',NA)),
c32_01_3 = factor(car::recode(c32_01, "1:2 = 1; 3 = 2; 4:5 = 3"),
levels = 1:3,
labels = c('Totalmente en desacuerdo\no en desacuerdo', 'Ni de acuerdo ni\nen desacuerdo', 'De acuerdo o Totalmente\nde acuerdo'))
) %>%
sjlabelled::as_label(ola) %>%
prop(x = c32_01 %in% c(4:5), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Orgullo de ser chileno, según ola', subtitle = 'Me siento orgulloso de ser chileno \nDe acuerdo o Totalmente de acuerdo') +
scale_y_continuous(labels = scales::percent,
limits = c(.75, 1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c32_02,pp_3)) %>%
drop_na(pp_3) %>%
mutate( c32_02_1 = ifelse(c32_02 %in% c(4:5),'De acuerdo o Totalmente de acuerdo',
ifelse(c32_02 %in% c(1:3),'',NA)),
c32_02_3 = factor(car::recode(c32_02, "1:2 = 1; 3 = 2; 4:5 = 3"),
levels = 1:3,
labels = c('Totalmente en desacuerdo\no en desacuerdo', 'Ni de acuerdo ni\nen desacuerdo', 'De acuerdo o Totalmente\nde acuerdo'))
) %>%
sjlabelled::as_label(ola) %>%
prop(x = c32_02 %in% c(4:5), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Identificación con Chile, según votante', subtitle = 'Me identifico con Chile \nDe acuerdo o Totalmente de acuerdo') +
scale_y_continuous(labels = scales::percent,
limits = c(.75, 1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) #+
facet_wrap(~pp_3)
elsoc_long_2016_2022 %>%
left_join(perfiles, by = 'idencuesta') %>%
filter(tipo_atricion == 1, !is_nsnr(c32_02,pp_3)) %>%
drop_na(pp_3) %>%
mutate( c32_02_1 = ifelse(c32_02 %in% c(4:5),'De acuerdo o Totalmente de acuerdo',
ifelse(c32_02 %in% c(1:3),'',NA)),
c32_02_3 = factor(car::recode(c32_02, "1:2 = 1; 3 = 2; 4:5 = 3"),
levels = 1:3,
labels = c('Totalmente en desacuerdo\no en desacuerdo', 'Ni de acuerdo ni\nen desacuerdo', 'De acuerdo o Totalmente\nde acuerdo'))
) %>%
sjlabelled::as_label(ola) %>%
prop(x = c32_02 %in% c(4:5), by = c(ola,pp_3), na.rm = TRUE) %>%
ggplot(aes(y = prop, x = ola, color = pp_3,group=pp_3,
label = as.character(scales::percent(prop, accuracy = .1)))) +
theme_bw() +
geom_text_repel(size = 3) +
geom_point(size = 1.75) +
geom_line() +
ggtitle(label = 'Identificación con Chile, según votante', subtitle = 'Me identifico con Chile \nDe acuerdo o Totalmente de acuerdo') +
scale_y_continuous(labels = scales::percent,
limits = c(.75, 1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank())
