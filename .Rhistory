scale_fill_viridis_d(begin = 0, end = .85, direction = -1) +
geom_text(position = position_dodge2(.9),
size = 3,
vjust = -.5) +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'none') +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
# elsoc::load_elsoc('long')
elsoc_long_2016_2022  %>%
filter(ola == 6,!is.na(salida)) %>%
prop(depr, by = c(salida), na.rm = TRUE) %>%
sjlabelled::as_label(depr, salida) %>%
ggplot(aes(y = prop, x = salida, fill = fct_rev(depr),
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_col(position = 'Stack') +
scale_y_continuous(labels = scales::percent) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(begin = 0, end = .85, option = 'viridis') +
geom_text(position = position_stack(vjust = .5),
size = 3,
color = rep(rep(c('black', 'white'), each = 2), 3)) +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
guides(fill = guide_legend(reverse = TRUE)) +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
# elsoc::load_elsoc('long')
elsoc_long_2016_2022 %>%
dplyr::filter(tipo_atricion == 1) %>%
prop(phq9 >= 10 , by = c(ola, m0_sexo), na.rm = TRUE) %>%
sjlabelled::as_label(ola, m0_sexo) %>%
ggplot(aes(y = prop, x = ola, color = m0_sexo, group = m0_sexo,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(nudge_y = .025, size = 3, color = 'black') +
scale_y_continuous(labels = scales::percent, limits = 0:1) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(begin = .33, end = .66) +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
# elsoc::load_elsoc('long')
p = elsoc_long_2016_2022 %>%
filter(tipo_atricion == 1, !is.na(m02)) %>%
mutate(sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3)) %>%
sjlabelled::as_label(ola) %>%
prop_list(sit_laboral==1, sit_laboral==2, sit_laboral==3, by = ola, na.rm = TRUE) %>%
mutate(name = factor(name,
levels = c('sit_laboral == 1', 'sit_laboral == 2', 'sit_laboral == 3'),
labels = c('Ocupados',
'Desocupados',
'Inactivos'))) %>%
ggplot(aes(y = prop, x = ola, group = name, color = name,
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_point(size = 1.75) +
geom_line() +
geom_text_repel(nudge_y = .025, size = 3, color = 'black') +
scale_y_continuous(labels = scales::percent, limits = c(0,1)) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_color_viridis_d(end = .75, option = 'viridis') +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
ggtitle(NULL, 'Situación Laboral por Ola') +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
p
# elsoc::load_elsoc('long')
elsoc_long_2016_2022 %>%
mutate(ola = ifelse(ola==1,"2016",
ifelse(ola==6,"2022",ola))) %>%
filter(ola==2016|ola==2022,muestra==1,!is.na(salida),!is.na(sit_laboral)) %>%
prop(salida, by = c(ola,sit_laboral), na.rm = TRUE) %>%
sjlabelled::as_label(salida, sit_laboral) %>%
ggplot(aes(y = prop, x = sit_laboral, fill = fct_rev(salida),
label = scales::percent(prop, accuracy = .1))) +
theme_bw() +
geom_col(position = 'Stack') +
scale_y_continuous(labels = scales::percent) +
ylab(label = NULL) +
xlab(label = NULL) +
scale_fill_viridis_d(begin = 0, end = .85, option = 'viridis') +
geom_text(position = position_stack(vjust = .5),
size = 3) +
theme(plot.caption = element_text(hjust = 0),
legend.position = 'top',
legend.title = element_blank()) +
guides(fill = guide_legend(reverse = TRUE)) +
facet_grid(~ola) +
labs(caption = 'Fuente: Elaboración propia en base a datos ELSOC 2016-2022.')
elsoc_long_2016_2022%>%
flat_table(ola,c01)
elsoc_long_2016_2022%>%
flat_table(ola,c02)
sjmisc::frq(elsoc_long_2016_2022$c02)
sjmisc::frq(elsoc_long_2016_2022$c03)
sjmisc::frq(elsoc_long_2016_2022$c04)
elsoc_long_2016_2022%>%
mutate(conf_inter=sum(c02==1|c03==1|c03==2))
elsoc_long_2016_2022%>%
mutate(conf_inter=sum(c02==1|c03==1|c03==2))%>%
frq(conf_inter)
elsoc_long_2016_2022%>%
mutate(conf_inter=sum(c02==1|c03==1|c04==2))%>%
select(idencuesta,ola,conf_inter)%>%
View()
elsoc_long_2016_2022%>%
select(idencuesta,ola,c02,c03,c04)%>%
View()
?mutate_at
?across
elsoc_long_2016_2022%>%
mutate(sum = rowSums(across(c02==1)))
elsoc_long_2016_2022%>%
mutate(conf_inter = (c02==1)+(c03==1))%>%
frq(conf_inter)
elsoc_long_2016_2022%>%
mutate(conf_inter = (c02==1)+(c03==1)+(c04==2))%>%
frq(conf_inter)
?elsoc::prop()
elsoc::prop_list()
elsoc::prop_list
?elsoc::prop_list
elsoc_long_2016_2022%>%
mutate(conf_inter = (c02==1)+(c03==1)+(c04==2))%>%
prop_list(conf_inter,by=c(muestra,ola),na.rm=TRUE)
elsoc_long_2016_2022%>%
mutate(conf_inter = (c02==1)+(c03==1)+(c04==2))%>%
prop_list(conf_inter,by=c(muestra,ola),na.rm=TRUE)%>%
ggplot(aes(x=factor(ola),y=prop,color=value))+
geom_point()
elsoc_long_2016_2022%>%
mutate(conf_inter = factor(car::recode((c02==1)+(c03==1)+(c04==2),
"0=0;1=1;c(2,3)=2"),
labels = c("Baja","Media","Alta"))%>%
filter(muestra==1)%>%
prop_list(conf_inter,by=c(muestra,ola),na.rm=TRUE)%>%
mutate()
ggplot(aes(x=factor(ola),y=prop,color=value,group=value))+
elsoc_long_2016_2022%>%
mutate(conf_inter = factor(car::recode((c02==1)+(c03==1)+(c04==2),
"0=0;1=1;c(2,3)=2"),
labels = c("Baja","Media","Alta"))%>%
filter(muestra==1)%>%
prop_list(conf_inter,by=c(muestra,ola),na.rm=TRUE)%>%
ggplot(aes(x=factor(ola),y=prop,color=value,group=value))+
geom_point()+
geom_line()
elsoc_long_2016_2022%>%
mutate(conf_inter = factor(car::recode((c02==1)+(c03==1)+(c04==2),
"0=0;1=1;c(2,3)=2"),
labels = c("Baja","Media","Alta")))%>%
filter(muestra==1)%>%
prop_list(conf_inter,by=c(muestra,ola),na.rm=TRUE)%>%
ggplot(aes(x=factor(ola),y=prop,color=value,group=value))+
geom_point()+
geom_line()
frq(elsoc_long_2016_2022$salida)
elsoc_long_2016_2022%>%
mutate(conf_inter = factor(car::recode((c02==1)+(c03==1)+(c04==2),
"0=0;1=1;c(2,3)=2"),
labels = c("Baja","Media","Alta")))%>%
filter(muestra==1,salida!=3)%>%
prop_list(conf_inter,by=c(ola,salida),na.rm=TRUE)%>%
ggplot(aes(x=factor(ola),y=prop,color=value,group=value))+
geom_point()+
geom_line()
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
elsoc_long_2016_2022%>%
mutate(conf_inter = factor(car::recode((c02==1)+(c03==1)+(c04==2),
"0=0;1=1;c(2,3)=2"),
labels = c("Baja","Media","Alta")))%>%
filter(muestra==1,salida!="Otros")%>%
prop_list(conf_inter,by=c(ola,salida),na.rm=TRUE)%>%
ggplot(aes(x=factor(ola),y=prop,color=value,group=value))+
geom_point()+
geom_line()+
facet_wrap(~salida)+
theme_bw()
elsoc_long_2016_2022%>%
mutate(conf_inter = factor(car::recode((c02==1)+(c03==1)+(c04==2),
"0=0;1=1;c(2,3)=2"),
labels = c("Baja","Media","Alta")))%>%
filter(muestra==1,salida!="Otros")%>%
prop_list(conf_inter,by=c(ola,salida),na.rm=TRUE)%>%
ggplot(aes(x=factor(ola),y=prop,color=value,group=value))+
geom_point()+
geom_line()+
facet_wrap(~salida)+
theme_bw()+
scale_fill_viridis_d(begin = 0, end = .85, option = 'viridis')
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
elsoc_long_2016_2022%>%
filter(tipo_atricion==1)%>%
sjlabelled::as_label(ola) %>%
prop_list(conf_inter,by=c(ola,pp_4),na.rm=TRUE)
load(file.path('..', 'inputs', 'ELSOC_Long_2016_2022_v1.00_R.RData'))
load(file.path('..', 'inputs', 'ELSOC_Wide_2016_2022_v1.00_R.RData'))
elsoc_long.0 <- elsoc_long_2016_2022
elsoc_long_2016_2022 <- elsoc_long.0 %>%
mutate(pleb = case_when(c55 == 4 ~ 5,
c55 == 1 ~ 1,
c55 == 2 ~ 2,
c55 == 3 ~ 3,
c55 == -999 ~ 5,
c55 == -888 ~ 5,
c55 == -777 ~ 5,
c55 == -666 ~ 5,
c56 == -999 ~ 5,
c56 == -888 ~ 5,
c56 == -777 ~ 5,
c56 == -666 ~ 5,
c56 == 2 ~ 4,
c57 == 1 ~ 1,
c57 == 2 ~ 2,
c57 == 3 ~ 3,
c57 == -999 ~ 5,
c57 == -888 ~ 5,
c57 == -777 ~ 5,
c57 == -666 ~ 5))  %>%
sjmisc::set_na(.,na=c(-666,-777,-888,-999))%>%
group_by(idencuesta) %>%
mutate(salida = ifelse(length(na.omit(pleb)) == 0, NA, max(pleb, na.rm = T))) %>%
ungroup()%>%
purrr::map_at(.at = vars(starts_with('s11_0')),
.f = function(s) car::recode(s, "1 = 0; 2 = 1; 3 = 2; c(4, 5) = 3; c(-888, -999) = NA")) %>%
as.data.frame() %>%
mutate(phq9 = (s11_01 + s11_02 + s11_03 + s11_04 + s11_05 + s11_06 + s11_07 + s11_08 + s11_09),
depr = factor(car::recode(phq9, "0:4 = 1; 5:9 = 2; 10:14 = 3; 15:27 = 4"),
levels = c(1,2,3,4),
labels = c('Sin sintomas o síntomas\nde depresión mínima',
'Síntomas de\ndepresion media',
'Síntomas de\ndepresion moderada',
'Síntomas de depresion\nmoderada-severa\no severa')),
salida = factor(car::recode(salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos")),
conf_inter = factor(car::recode((c02==1)+(c03==1)+(c04==2),
"0=0;1=1;c(2,3)=2"),
labels = c("Baja","Media","Alta")))
source("~/.active-rstudio-document", echo=TRUE)
elsoc_long_2016_2022%>%
filter(tipo_atricion==1)%>%
sjlabelled::as_label(ola) %>%
prop_list(conf_inter,by=c(ola,pp_4),na.rm=TRUE)
load(file.path('..', 'inputs', 'perfiles.RData'))
elsoc_long_2016_2022 <- elsoc_long_2016_2022 %>%
left_join(perfiles, by = "idencuesta")%>%
mutate(pp_4 = factor(pp_4,
levels = 1:4,
labels = c("Votante\nCrónico (64.24%)", "Desafecto (8.30%)", "No-Votante\nCrónico (14.28%)", "Activado (13.17%)")))
elsoc_long_2016_2022%>%
filter(tipo_atricion==1)%>%
sjlabelled::as_label(ola) %>%
prop_list(conf_inter,by=c(ola,pp_4),na.rm=TRUE)
load(file.path('..', 'inputs', 'perfiles.RData'))
elsoc_long_2016_2022 <- elsoc_long_2016_2022 %>%
left_join(perfiles, by = "idencuesta")%>%
mutate(pp_4 = factor(pp_4,
levels = 1:4,
labels = c("Votante\nCrónico", "Desafecto", "No-Votante\nCrónico (14.28%)", "Activado")))
load(file.path('..', 'inputs', 'ELSOC_Long_2016_2022_v1.00_R.RData'))
load(file.path('..', 'inputs', 'ELSOC_Wide_2016_2022_v1.00_R.RData'))
elsoc_long.0 <- elsoc_long_2016_2022
elsoc_long_2016_2022 <- elsoc_long.0 %>%
mutate(pleb = case_when(c55 == 4 ~ 5,
c55 == 1 ~ 1,
c55 == 2 ~ 2,
c55 == 3 ~ 3,
c55 == -999 ~ 5,
c55 == -888 ~ 5,
c55 == -777 ~ 5,
c55 == -666 ~ 5,
c56 == -999 ~ 5,
c56 == -888 ~ 5,
c56 == -777 ~ 5,
c56 == -666 ~ 5,
c56 == 2 ~ 4,
c57 == 1 ~ 1,
c57 == 2 ~ 2,
c57 == 3 ~ 3,
c57 == -999 ~ 5,
c57 == -888 ~ 5,
c57 == -777 ~ 5,
c57 == -666 ~ 5))  %>%
sjmisc::set_na(.,na=c(-666,-777,-888,-999))%>%
group_by(idencuesta) %>%
mutate(salida = ifelse(length(na.omit(pleb)) == 0, NA, max(pleb, na.rm = T))) %>%
ungroup()%>%
purrr::map_at(.at = vars(starts_with('s11_0')),
.f = function(s) car::recode(s, "1 = 0; 2 = 1; 3 = 2; c(4, 5) = 3; c(-888, -999) = NA")) %>%
as.data.frame() %>%
mutate(phq9 = (s11_01 + s11_02 + s11_03 + s11_04 + s11_05 + s11_06 + s11_07 + s11_08 + s11_09),
depr = factor(car::recode(phq9, "0:4 = 1; 5:9 = 2; 10:14 = 3; 15:27 = 4"),
levels = c(1,2,3,4),
labels = c('Sin sintomas o síntomas\nde depresión mínima',
'Síntomas de\ndepresion media',
'Síntomas de\ndepresion moderada',
'Síntomas de depresion\nmoderada-severa\no severa')),
salida = factor(car::recode(salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos")),
conf_inter = factor(car::recode((c02==1)+(c03==1)+(c04==2),
"0=0;1=1;c(2,3)=2"),
labels = c("Baja","Media","Alta")))
load(file.path('..', 'inputs', 'perfiles.RData'))
elsoc_long_2016_2022 <- elsoc_long_2016_2022 %>%
left_join(perfiles, by = "idencuesta")%>%
mutate(pp_4 = factor(pp_4,
levels = 1:4,
labels = c("Votante\nCrónico", "Desafecto", "No-Votante\nCrónico (14.28%)", "Activado")))
source("~/.active-rstudio-document", echo=TRUE)
load(file.path('..', 'inputs', 'ELSOC_Long_2016_2022_v1.00_R.RData'))
load(file.path('..', 'inputs', 'ELSOC_Wide_2016_2022_v1.00_R.RData'))
elsoc_long.0 <- elsoc_long_2016_2022
elsoc_long_2016_2022 <- elsoc_long.0 %>%
mutate(pleb = case_when(c55 == 4 ~ 5,
c55 == 1 ~ 1,
c55 == 2 ~ 2,
c55 == 3 ~ 3,
c55 == -999 ~ 5,
c55 == -888 ~ 5,
c55 == -777 ~ 5,
c55 == -666 ~ 5,
c56 == -999 ~ 5,
c56 == -888 ~ 5,
c56 == -777 ~ 5,
c56 == -666 ~ 5,
c56 == 2 ~ 4,
c57 == 1 ~ 1,
c57 == 2 ~ 2,
c57 == 3 ~ 3,
c57 == -999 ~ 5,
c57 == -888 ~ 5,
c57 == -777 ~ 5,
c57 == -666 ~ 5))  %>%
sjmisc::set_na(.,na=c(-666,-777,-888,-999))%>%
group_by(idencuesta) %>%
mutate(salida = ifelse(length(na.omit(pleb)) == 0, NA, max(pleb, na.rm = T))) %>%
ungroup()%>%
purrr::map_at(.at = vars(starts_with('s11_0')),
.f = function(s) car::recode(s, "1 = 0; 2 = 1; 3 = 2; c(4, 5) = 3; c(-888, -999) = NA")) %>%
as.data.frame() %>%
mutate(phq9 = (s11_01 + s11_02 + s11_03 + s11_04 + s11_05 + s11_06 + s11_07 + s11_08 + s11_09),
depr = factor(car::recode(phq9, "0:4 = 1; 5:9 = 2; 10:14 = 3; 15:27 = 4"),
levels = c(1,2,3,4),
labels = c('Sin sintomas o síntomas\nde depresión mínima',
'Síntomas de\ndepresion media',
'Síntomas de\ndepresion moderada',
'Síntomas de depresion\nmoderada-severa\no severa')),
salida = factor(car::recode(salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos")),
conf_inter = factor(car::recode((c02==1)+(c03==1)+(c04==2),
"0=0;1=1;c(2,3)=2"),
labels = c("Baja","Media","Alta")))%>%
left_join(perfiles, by = "idencuesta")%>%
mutate(pp_4 = factor(pp_4,
levels = 1:4,
labels = c("Votante\nCrónico", "Desafecto", "No-Votante\nCrónico (14.28%)", "Activado")))
load(file.path('..', 'inputs', 'ELSOC_Long_2016_2022_v1.00_R.RData'))
load(file.path('..', 'inputs', 'ELSOC_Wide_2016_2022_v1.00_R.RData'))
load(file.path('..', 'inputs', 'perfiles.RData'))
elsoc_long.0 <- elsoc_long_2016_2022
elsoc_long_2016_2022 <- elsoc_long.0 %>%
mutate(pleb = case_when(c55 == 4 ~ 5,
c55 == 1 ~ 1,
c55 == 2 ~ 2,
c55 == 3 ~ 3,
c55 == -999 ~ 5,
c55 == -888 ~ 5,
c55 == -777 ~ 5,
c55 == -666 ~ 5,
c56 == -999 ~ 5,
c56 == -888 ~ 5,
c56 == -777 ~ 5,
c56 == -666 ~ 5,
c56 == 2 ~ 4,
c57 == 1 ~ 1,
c57 == 2 ~ 2,
c57 == 3 ~ 3,
c57 == -999 ~ 5,
c57 == -888 ~ 5,
c57 == -777 ~ 5,
c57 == -666 ~ 5))  %>%
sjmisc::set_na(.,na=c(-666,-777,-888,-999))%>%
group_by(idencuesta) %>%
mutate(salida = ifelse(length(na.omit(pleb)) == 0, NA, max(pleb, na.rm = T))) %>%
ungroup()%>%
purrr::map_at(.at = vars(starts_with('s11_0')),
.f = function(s) car::recode(s, "1 = 0; 2 = 1; 3 = 2; c(4, 5) = 3; c(-888, -999) = NA")) %>%
as.data.frame() %>%
mutate(phq9 = (s11_01 + s11_02 + s11_03 + s11_04 + s11_05 + s11_06 + s11_07 + s11_08 + s11_09),
depr = factor(car::recode(phq9, "0:4 = 1; 5:9 = 2; 10:14 = 3; 15:27 = 4"),
levels = c(1,2,3,4),
labels = c('Sin sintomas o síntomas\nde depresión mínima',
'Síntomas de\ndepresion media',
'Síntomas de\ndepresion moderada',
'Síntomas de depresion\nmoderada-severa\no severa')),
salida = factor(car::recode(salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos")),
conf_inter = factor(car::recode((c02==1)+(c03==1)+(c04==2),
"0=0;1=1;c(2,3)=2"),
labels = c("Baja","Media","Alta")))%>%
left_join(perfiles, by = "idencuesta")%>%
mutate(pp_4 = factor(pp_4,
levels = 1:4,
labels = c("Votante\nCrónico", "Desafecto", "No-Votante\nCrónico (14.28%)", "Activado")))
elsoc_long_2016_2022$conf_inter
elsoc_long_2016_2022%>%
filter(tipo_atricion==1)%>%
sjlabelled::as_label(ola) %>%
prop_list(conf_inter,by=c(ola,pp_4),na.rm=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
load(file.path('..', 'inputs', 'ELSOC_Long_2016_2022_v1.00_R.RData'))
load(file.path('..', 'inputs', 'ELSOC_Wide_2016_2022_v1.00_R.RData'))
load(file.path('..', 'inputs', 'perfiles.RData'))
elsoc_long.0 <- elsoc_long_2016_2022
elsoc_long_2016_2022 <- elsoc_long.0 %>%
mutate(pleb = case_when(c55 == 4 ~ 5,
c55 == 1 ~ 1,
c55 == 2 ~ 2,
c55 == 3 ~ 3,
c55 == -999 ~ 5,
c55 == -888 ~ 5,
c55 == -777 ~ 5,
c55 == -666 ~ 5,
c56 == -999 ~ 5,
c56 == -888 ~ 5,
c56 == -777 ~ 5,
c56 == -666 ~ 5,
c56 == 2 ~ 4,
c57 == 1 ~ 1,
c57 == 2 ~ 2,
c57 == 3 ~ 3,
c57 == -999 ~ 5,
c57 == -888 ~ 5,
c57 == -777 ~ 5,
c57 == -666 ~ 5))  %>%
sjmisc::set_na(.,na=c(-666,-777,-888,-999))%>%
group_by(idencuesta) %>%
mutate(salida = ifelse(length(na.omit(pleb)) == 0, NA, max(pleb, na.rm = T))) %>%
ungroup()%>%
purrr::map_at(.at = vars(starts_with('s11_0')),
.f = function(s) car::recode(s, "1 = 0; 2 = 1; 3 = 2; c(4, 5) = 3; c(-888, -999) = NA")) %>%
as.data.frame() %>%
mutate(phq9 = (s11_01 + s11_02 + s11_03 + s11_04 + s11_05 + s11_06 + s11_07 + s11_08 + s11_09),
depr = factor(car::recode(phq9, "0:4 = 1; 5:9 = 2; 10:14 = 3; 15:27 = 4"),
levels = c(1,2,3,4),
labels = c('Sin sintomas o síntomas\nde depresión mínima',
'Síntomas de\ndepresion media',
'Síntomas de\ndepresion moderada',
'Síntomas de depresion\nmoderada-severa\no severa')),
salida = factor(car::recode(salida, "1 = 1; 2 = 2; 3:5 = 3"),
levels = 1:3,
labels = c("Apruebo", "Rechazo", "Otros")),
sit_laboral = factor(car::recode(m02, "1:3 = 1; 6 = 2; c(4,5,7,8,9) = 3"),
levels = 1:3,
labels = c("Ocupados","Desocupados","Inactivos")),
conf_inter = factor(car::recode((c02==1)+(c03==1)+(c04==2),
"0=0;1=1;c(2,3)=2"),
labels = c("Baja","Media","Alta")))%>%
left_join(perfiles, by = "idencuesta")%>%
mutate(pp_4 = factor(pp_4,
levels = 1:4,
labels = c("Votante\nCrónico", "Desafecto", "No-Votante\nCrónico", "Activado")))
source("~/.active-rstudio-document", echo=TRUE)
load(file.path('inputs', 'ELSOC_Long_2016_2022_v1.00_R.RData'))
source("~/.active-rstudio-document", echo=TRUE)
saveRDS(elsoc_long_2016_2022,file = "inputs/Bienestar/base_bienestar.RDS")
base_bienestar <- readRDS("C:/RProjects/ELSOC 2022/rcs_v1/inputs/Bienestar/base_bienestar.RDS")
elsoc_long_2016_2022<-  readRDS("../inputs/Bienestar/base_bienestar.RDS")
source("C:/RProjects/ELSOC 2022/rcs_v1/inputs/Bienestar/graficos/crear graficos modulo bienestar.R", echo=TRUE)
source("C:/RProjects/ELSOC 2022/rcs_v1/inputs/Bienestar/graficos/crear graficos modulo bienestar.R", echo=TRUE)
gf_conf_inter <- readRDS("C:/RProjects/ELSOC 2022/rcs_v1/inputs/Bienestar/graficos/gf_conf_inter.RDS")
gf_conf_inter <- readRDS("../inputs/Bienestar/graficos/gf_conf_inter.RDS")
gf_conf_inter
xaringan::inf_mr()
